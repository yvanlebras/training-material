<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Regional GAM</title>
        
            <!--
<script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
-->
<!-- We let users opt-out, so if they've opted in, we need to append the plausible script to the body -->

<script>
var scriptElement = document.createElement("script");
scriptElement.async = true;
scriptElement.defer = true;
scriptElement.setAttribute("data-domain", "training.galaxyproject.org");
scriptElement.src = "https://plausible.galaxyproject.eu/js/plausible.js";

// Appending the script element to the body
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Plausible: opt-in");
	// Wait for the document to be available
	document.addEventListener("DOMContentLoaded", function(event) {
		document.body.appendChild(scriptElement);
	});
}
</script>

<!-- JavaScript Error Monitoring, and performance tracking. -->
<!--
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
-->
<script type="text/javascript">
var scriptElement = document.createElement("script");
scriptElement.src = "https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js";
scriptElement.integrity = "sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43";
scriptElement.crossOrigin = "anonymous";

if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	// Appending the script element to the body
	document.addEventListener("DOMContentLoaded", function(event) {
		document.body.appendChild(scriptElement);
	});
		
	Sentry.init({
	  dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
	  release: "galaxy-training-network@ee51c939937f9893c63a0f9494eaef0bfbfa1c6d",
	  integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
	  sampleRate: 0.1,
	  tracesSampleRate: 0.1,
	  // Capture Replay for no sessions by default
	  replaysSessionSampleRate: 0.01,
	  // plus for 1% of sessions with an error
	  replaysOnErrorSampleRate: 0.01,
	  // PII OFF
	  sendDefaultPii: false, // Off by default but just in case.
	  environment: "production",
	});
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.js?v=1707351988' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.js?v=1707351988' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>


        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Regional GAM">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2023-05-17 17:21:19 +0000">
<meta name="DC.creator" content="Clara Urfer">
<meta name="DC.creator" content="Elisa Michon">
<meta name="DC.creator" content="Yvan Le Bras">
<meta name="DC.creator" content="Bérénice Batut">
<meta name="DC.creator" content="Simon Benateau">

        
        
        
        
        <meta name="description" content="Learn to analyse Ecological data through Galaxy.">
        <meta property="og:site_name" content="Galaxy Training Network">
        <meta property="og:title" content="Galaxy Training: Regional GAM">
        <meta property="og:description" content="Learn to analyse Ecological data through Galaxy.">
        
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png">

        
        <script type="application/ld+json">
            


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "2023-05-17 17:21:19 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Regional GAM",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "identifier": "https://github.com/galaxyproject/training-material",
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Ecology",
    "description": "Learn to analyse Ecological data through Galaxy.",
    "url": "https://training.galaxyproject.org/training-material/topics/ecology/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Regional GAM' tutorial",
  "url": "https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html",
  "timeRequired": "PT2H30M",
  "teaches": "Obtain and filter/manipulate occurrence data\n - Compute and visualize phenology of a species through the years\n - Compute temporal abundance trends",
  "keywords": "ecology, Species populations EBV class, Species traits EBV class, EBV dataset, EBV workflow",
  "description": "The questions this  addresses are:\n - What are abundance and trends of a butterfly species?\n\n\nThe objectives are:\n - Obtain and filter/manipulate occurrence data\n - Compute and visualize phenology of a species through the years\n - Compute temporal abundance trends\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/claraurf/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/claraurf/",
      "name": "Clara Urfer",
      "image": "https://avatars.githubusercontent.com/claraurf",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/emichn/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/emichn/",
      "name": "Elisa Michon",
      "image": "https://avatars.githubusercontent.com/emichn",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/yvanlebras/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/yvanlebras/",
      "name": "Yvan Le Bras",
      "image": "https://avatars.githubusercontent.com/yvanlebras",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-8504-068X",
      "orcid": "https://orcid.org/0000-0002-8504-068X"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "name": "Bérénice Batut",
      "image": "https://avatars.githubusercontent.com/bebatut",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9852-1987",
      "orcid": "https://orcid.org/0000-0001-9852-1987"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/sbenateau/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/sbenateau/",
      "name": "Simon Benateau",
      "image": "https://avatars.githubusercontent.com/sbenateau",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Ecology",
      "description": "Learn to analyse Ecological data through Galaxy.",
      "url": "https://training.galaxyproject.org/training-material/topics/ecology/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0610",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0610",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0610"
    }
  ],
  "educationalLevel": "Introductory",
  "mentions": [
    {
      "@type": "Thing",
      "name": "Species populations EBV class"
    },
    {
      "@type": "Thing",
      "name": "Species traits EBV class"
    },
    {
      "@type": "Thing",
      "name": "EBV dataset"
    },
    {
      "@type": "Thing",
      "name": "EBV workflow"
    }
  ],
  "abstract": "# Introduction"
}
        </script>
        
    </head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script src='/training-material/assets/js/bundle.theme.js?v=1707351988'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/ecology" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Ecology
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        <a class="dropdown-item" href="/training-material/topics/ecology/faqs/" title="Check our FAQs for the Ecology topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/ecology/tutorials/regionalGAM/tutorial.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                    <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

		<a href="/training-material/preferences.html" class="dropdown-item">
			<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Themes have moved <span class="badge badge-secondary">New</span>
		</a>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-ecology">
    <h1 data-toc-skip>Regional GAM</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/claraurf/" class="contributor-badge contributor-claraurf"><img src="https://avatars.githubusercontent.com/claraurf?s=36" alt="Avatar" width="36" height="36">Clara Urfer</a><a href="/training-material/hall-of-fame/emichn/" class="contributor-badge contributor-emichn"><img src="https://avatars.githubusercontent.com/emichn?s=36" alt="Avatar" width="36" height="36">Elisa Michon</a><a href="/training-material/hall-of-fame/yvanlebras/" class="contributor-badge contributor-yvanlebras"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/yvanlebras?s=36" alt="Avatar" width="36" height="36">Yvan Le Bras</a><a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Avatar" width="36" height="36">Bérénice Batut</a><a href="/training-material/hall-of-fame/sbenateau/" class="contributor-badge contributor-sbenateau"><img src="https://avatars.githubusercontent.com/sbenateau?s=36" alt="Avatar" width="36" height="36">Simon Benateau</a>
	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>What are abundance and trends of a butterfly species?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Obtain and filter/manipulate occurrence data</p>
</li>
        
        <li><p>Compute and visualize phenology of a species through the years</p>
</li>
        
        <li><p>Compute temporal abundance trends</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

        
        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 2 hours 30 minutes</div>
        

        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/1324204#.W2BmRn7fNE4">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/ecology/tutorials/regionalGAM/workflows/" title="Regional GAM workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/ecology/tutorials/regionalGAM/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            













  



            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
    

    
	<li class="dropdown-header">
		Containers
	</li>
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics//docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> May 17, 2023 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Tutorial Content is licensed under Creative Commons Attribution 4.0 International License</a>.
             The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00134">https://gxy.io/GTN:T00134</a> </div>
        
    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <h1 id="introduction">Introduction</h1>

<p>This tutorial will show you how to study species abundance through the computation of a flight curve, abundance index, and trends. It will explain you how to use different <a href="https://github.com/RetoSchmucki/regionalGAM">regionalGAM</a> tools on Galaxy allowing you to deal with datasets containing abundance information for various species per site and per date through a couple of years.</p>

<p>After a certain number of steps, you will be able to extract single species data and study related abundance through the years. The goal of this exercise is to be able to create abundance trend over time and biodiversity indicators. Following these indicators allow to follow trends in terms of population dynamics. You could for example try to predict the occurrences of one specific species in a certain type of environment using the prediction model of climate evolution. Based on charts that you will generate, you could try to explain the evolution of a species with environmental data (temperatures variations, modifications of the environmental conditions).</p>

<p>You will basically learn how to create a file on the basis of which you can create a visual material that can be quite easily understood and therefore be efficient for a large audience.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#step-1-pre-processing" id="markdown-toc-step-1-pre-processing">Step 1: Pre-processing</a>    <ol>
      <li><a href="#data-upload" id="markdown-toc-data-upload">Data upload</a></li>
      <li><a href="#prepare-the-data" id="markdown-toc-prepare-the-data">Prepare the data</a></li>
      <li><a href="#check-that-the-dataset-contains-only-one-species" id="markdown-toc-check-that-the-dataset-contains-only-one-species">Check that the dataset contains only one species</a></li>
    </ol>
  </li>
  <li><a href="#step-2-analyze-phenology-of-a-species-through-the-years" id="markdown-toc-step-2-analyze-phenology-of-a-species-through-the-years">Step 2: Analyze phenology of a species through the years</a>    <ol>
      <li><a href="#compute-and-visualize-the-phenology" id="markdown-toc-compute-and-visualize-the-phenology">Compute and visualize the phenology</a></li>
      <li><a href="#compute-abundance-index-across-sites-and-years" id="markdown-toc-compute-abundance-index-across-sites-and-years">Compute Abundance Index across sites and years</a></li>
      <li><a href="#compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend" id="markdown-toc-compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend">Compute a collated index for each year and estimates the temporal trend</a></li>
      <li><a href="#model-temporal-trend" id="markdown-toc-model-temporal-trend">Model temporal trend</a></li>
      <li><a href="#take-into-account-the-autocorrelation" id="markdown-toc-take-into-account-the-autocorrelation">Take into account the autocorrelation</a></li>
    </ol>
  </li>
  <li><a href="#conclusions" id="markdown-toc-conclusions">Conclusions</a></li>
</ol>

</blockquote>

<h1 id="step-1-pre-processing">Step 1: Pre-processing</h1>

<p>The goal of the first step is to upload and prepare the file so that it will be usable for the <em>regional GAM</em> analysis.</p>

<h2 id="data-upload">Data upload</h2>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Create a new history for this tutorial and give it a proper name like <code class="language-plaintext highlighter-rouge">regionalGAM tutorial</code></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Creating a new history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>   <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>   <ol>   <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>   <li>Select the option <strong>Create New</strong> from the menu</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Renaming a history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Import the CSV dataset file with only one species from <a href="https://zenodo.org/record/1324204#.W2BmRn7fNE4">Zenodo</a> or from the data library (ask your instructor)</p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/1324204/files/regional%20GAM%20data.csv
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing via links<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-data-from-a-data-library"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-from-a-data-library" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing data from a data library<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class="fas fa-caret-down" aria-hidden="true"></i><span class="visually-hidden">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Check that the file contains a header corresponding to: <code class="language-plaintext highlighter-rouge">"SPECIES","SITE","YEAR","MONTH","DAY","COUNT"</code>, and that all the non numeric content are between double quotes as “x” and that separators are “,”</p>
    </li>
  </ol>

</blockquote>

<p>This dataset gathers years of records of the presence of butterfly species per site and per day. Columns indicates species names (“SPECIES”), observation site (“SITE”), date of the observation (“YEAR”,”MONTH”,”DAY”) and number of individuals (“COUNT”). It compiles counts for the Gatekeeper (Pironia tithonus) collected between 2003 and 2012 and extracted from five European BMSs (United Kingdom, Netherlands, France, Germany, and Catalonia-Spain). The Gatekeeper has one generation per year and feeds mainly on Poaceae. It is found in the Central and Southern Europe, North Africa Anatolia, and Caucasus.</p>

<p><a href="../../images/regionalGAM/Gatekeeper-Pyronia_tithonus-male.jpg" rel="noopener noreferrer"><figure id="figure-1" style="max-width: 90%; margin:auto;"><img src="../../images/regionalGAM/Gatekeeper-Pyronia_tithonus-male.jpg" alt="Gatekeeper (Pironia tithonus). " width="800" height="533" loading="lazy" />&lt;figcaption&gt;<span class="figcaption-prefix"><strong>Figure 1</strong>:</span> Gatekeeper (Pironia tithonus) Charles J Sharp&lt;/figcaption&gt;</figure></a></p>

<h2 id="prepare-the-data">Prepare the data</h2>

<p>The current dataset contains a lot of data (exact site names for 5 butterfly monitoring scheme). Processing the file in this condition would require time and for the purpose of this tutorial, we will reduce the number of sites. The column with header <code class="language-plaintext highlighter-rouge">SITE</code> of the dataset you are using is really long and the <code class="language-plaintext highlighter-rouge">SITES</code> are classified into sub-sites (like <code class="language-plaintext highlighter-rouge">ESBMS.12</code>, <code class="language-plaintext highlighter-rouge">ESBMS.28</code>, <code class="language-plaintext highlighter-rouge">ESBMS.55</code>, etc).</p>

<p>Here, we will only keep the sites that are in the Netherlands (NLBMS.XX). We want to create a down-sampled file, by selecting the lines where NLBMS is found.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-downsample-and-hide-some-information"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Downsample and hide some information</div>
  <ol>
    <li><strong>Text reformatting with awk</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Select cells from”</em>: Uploaded CSV dataset file <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>
          <p><em>“AWK Program”</em>:</p>

          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> NR == 1 { print }
 /NLBMS/ { print }
</code></pre></div>          </div>
        </li>
      </ul>
    </li>
  </ol>

  <p>The first line will skip and print the header and the second will print all the lines where NLBMS is found
Warning: depending on the Galaxy instance your are using, this tool can not appear on the tool panel. Another solution can be to use <strong>Select lines that match an expression</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to select lines matching ‘NLBMS’ pattern in addition to <strong>Select first lines from a dataset</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> specifying keeping the first line, so the header, then <strong>Concatenate datasets tail-to-head</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to recreate a CSV file from concatenating the header and NLBMS lines of the original csv file.</p>

</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>How many sites do you have before and after removing the sites from outside the Netherlands?</p>

  <p>You may need to use a tool like <strong>Count occurrences of each record</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>. If you want to run the same tool with same parameters to several input files, you can directly specify the <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <strong>Multiple datasets</strong> option on the tool form for the <em>“from dataset”</em> parameter).</p>

  <!--SNIPPET-->
  <blockquote class="tip">   <div class="box-title tip-title" id="tip-select-multiple-datasets"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-select-multiple-datasets" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Select multiple datasets<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <strong>Multiple datasets</strong></li>   <li>Select several files by keeping the <kbd>Ctrl</kbd> (or <kbd>COMMAND</kbd>) key pressed and clicking on the files of interest</li> </ol> </blockquote>
  <p><!--END_SNIPPET--></p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>The dataset contains 280 sites now against 1143 before down-sampling.</p>
  </blockquote>
</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-if-your-original-data-is-in-rdata-format"><button class="gtn-boxify-button details" type="button" aria-controls="details-if-your-original-data-is-in-rdata-format" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> Details: If your original data is in RData format<span class="fold-unfold fa fa-minus-square"></span></button></div>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-data-upload-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload.</div>
    <ol>
      <li>
        <p>Import the RData</p>

        <p>For example, you can upload:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/1324204/files/gatekeeper_CM%20.RData
</code></pre></div>        </div>
      </li>
      <li><strong>RData binary file reader</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Rdata binary file to explore”</em>: imported RData</li>
        </ul>
      </li>
      <li><strong>RData parser</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Rdata file to explore”</em>: imported RData</li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File with .Rdata content details”</em>: output of <strong>RData binary file reader</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“Select which attribute(s) you want to extract”</em>: select everything but “trend”</li>
          <li><em>“Bind variables in a single tabular when its possible”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>

  <p>If the tool <strong>RData parser</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> don’t succeed to create a single tabular file, it generates separate files, each of them containing one column. The file with the <code class="language-plaintext highlighter-rouge">TREND</code> header can be let aside as we don’t need it for what will follow.</p>

  <blockquote class="question">
    <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <p>If Rdata parser fails to generate a single unified tabular file, can you propose a way to regenerate such a dataset ?</p>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
      <p>You can do that using:</p>
      <ol>
        <li><strong>Paste two files side by side tool</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“paste”</em>: output from <strong>RData parser</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> headed with “SPECIES”</li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span><em>“and”</em>: output from <strong>RData parser</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with headed with “SITE”</li>
          </ul>
        </li>
        <li>Repeat <strong>Paste two files side by side</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> executions as many times as there are separated files in order to create a final dataset with all the columns:
          <ol>
            <li>Repeat <strong>Paste two files side by side tool</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to paste the file containing 2 columns with the one headed by <code class="language-plaintext highlighter-rouge">YEAR</code></li>
            <li>Repeat <strong>Paste two files side by side tool</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to paste the file containing 3 columns with the one headed by <code class="language-plaintext highlighter-rouge">MONTH</code></li>
            <li>Repeat <strong>Paste two files side by side tool</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to paste the file containing 4 columns with the one headed by <code class="language-plaintext highlighter-rouge">DAY</code></li>
            <li>Repeat <strong>Paste two files side by side tool</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to paste the file containing 5 columns with the one headed by <code class="language-plaintext highlighter-rouge">COUNT</code></li>
          </ol>
        </li>
      </ol>
    </blockquote>
  </blockquote>
</blockquote>

<h2 id="check-that-the-dataset-contains-only-one-species">Check that the dataset contains only one species</h2>

<p>The second step of any Regional GAM data analysis is making sure to have a dataset of only one specific species that you will then be able to use. If you want to create a graph showing abundance evolution by years of several species, you will have to superimpose the graphs on one another.</p>

<p>As the dataset is quite big and may contain heterogeneous information, we need to know whether the data are about one species or more.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-how-many-species-are-taken-into-account-in-this-dataset"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: How many species are taken into account in this dataset?</div>

  <ol>
    <li><strong>Count occurrences of each record</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“from dataset”</em>: output of <strong>Text reformatting with awk</strong></li>
        <li><em>“Count occurrences of values in column(s)”</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code>, the <code class="language-plaintext highlighter-rouge">SPECIES</code> column</li>
        <li><em>“Delimited by”</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><em>“How should the results be sorted?”</em>: <code class="language-plaintext highlighter-rouge">With the most common values first</code></li>
      </ul>
    </li>
    <li>Inspect the generated file by clicking on the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon (<strong>View data</strong>)</li>
    <li>Check that the dataset is for one species only</li>
  </ol>
</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-datasets-containing-information-about-more-than-one-species"><button class="gtn-boxify-button details" type="button" aria-controls="details-datasets-containing-information-about-more-than-one-species" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> Details: Datasets containing information about more than one species<span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>If your dataset contains information about more than one species, you can apply the previous steps and then run an extra-step to select one specific species and show all the data corresponding to it.</p>

  <p>As the dataset is quite big and contains heterogeneous information, you want to know whether the data are about one species or more. So the first step consists to count how many species are taken into account in this dataset.</p>

  <p>To test these steps, you can use the following dataset:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  https://zenodo.org/record/1324204/files/Dataset%20multispecies%20Regional%20GAM.csv
</code></pre></div>  </div>

  <blockquote class="question">
    <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <ol>
      <li>How many species does your initial dataset take into account ?</li>
      <li>What are their names ?</li>
    </ol>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>

      <ol>
        <li>The dataset contains information on 2 different species</li>
        <li>Their names are “Pyronia tithonus” and “Aglais io”.</li>
      </ol>

    </blockquote>
  </blockquote>

  <p>We now need to create a new file containing the data for only one species</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-creating-a-new-file-containing-only-the-data-from-one-species"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Creating a new file containing only the data from one species</div>
    <ol>
      <li>Copy the name of the species you are interested in (for example: “Aglais io”).</li>
      <li><strong>Filter data on any column using simple expressions</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Filter”</em>: output of <strong>Text reformatting with awk</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
          <li><em>“With following condition”</em>: <code class="language-plaintext highlighter-rouge">c1=='"Aglais io"'</code> or (another species name)</li>
          <li><em>“Number of header lines to skip”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
        </ul>

        <p>You can repeat this set of actions as much as necessary, changing only the name of the species taken into account. By doing this, you will obtain separated dataset, each of them containing a different species.</p>
      </li>
      <li>Repeat the last step on all the different <code class="language-plaintext highlighter-rouge">outputs</code> from <strong>Filter data on any column using simple expressions</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> that you have, one by species</li>
      <li>Tag your new dataset with an explicit tags as “Count” and “Aglais io” and/or rename this dataset like “Aglais io count file”.</li>
    </ol>
  </blockquote>

  <p>If you want to create a graph showing abundance evolution by years of several species, you will have to superimpose the graphs on one another.</p>
</blockquote>

<h1 id="step-2-analyze-phenology-of-a-species-through-the-years">Step 2: Analyze phenology of a species through the years</h1>

<h2 id="compute-and-visualize-the-phenology">Compute and visualize the phenology</h2>

<p><a href="https://en.wikipedia.org/wiki/Phenology">Phenology</a>, as described in Wikipedia, is the study of periodic plant and animal life cycle events and how these are influenced by seasonal and inter-annual variations in climate, as well as habitat factors (such as elevation).</p>

<p>Now you have a file containing all the data on the species of interest. The main goal of this step is to model one phenology per year using a general additive model (GAM) with time and sites as explanatory variables. This model will be used to predict values for missing counts at local sites in order to improve the quality of the abundance indices.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-phenology"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Phenology</div>
  <ol>
    <li><strong>Flight curve</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Count file”</em>: output file you just generated with the <strong>Text reformatting with awk</strong> or <strong>Filter data on any column using simple expressions</strong> if your file was containing more than one species <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      </ul>
    </li>
    <li>Generate the chart using the visualization
      <ol>
        <li>Inspect and expand the output data from <strong>Flight curve</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>Click on the <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>
        <li>Select <strong>Line chart (NVD3)</strong> as visualization type</li>
        <li>Give it a proper name, e.g. <code class="language-plaintext highlighter-rouge">Pyronia tithonus phenology raw simple vizu</code></li>
        <li>On <strong>Select data</strong> area, specify:
          <ul>
            <li><em>“Provide a label”</em>: <code class="language-plaintext highlighter-rouge">Pyronia tithonus phenology from 2003 to 2012</code> for example</li>
            <li><em>“Pick a series color”</em>: Choose a color for the line</li>
            <li><em>“Data point labels”</em>: <code class="language-plaintext highlighter-rouge">Column 1</code></li>
            <li><em>“Values for x-axis”</em>: <code class="language-plaintext highlighter-rouge">Column 2</code></li>
            <li><em>“Values for y-axis”</em>: <code class="language-plaintext highlighter-rouge">Column 6</code></li>
          </ul>
        </li>
        <li>On <strong>Change settings</strong>, specify:
          <ul>
            <li><em>“X-Axis label”</em>: <code class="language-plaintext highlighter-rouge">Year</code></li>
            <li><em>“Y-Axis label”</em>: <code class="language-plaintext highlighter-rouge">nm values</code></li>
          </ul>
        </li>
        <li>Click on <strong>Save</strong></li>
      </ol>
    </li>
  </ol>

</blockquote>

<p><a href="../../images/regionalGAM/phenology_year.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/phenology_year.png" alt="Phenology chart. " width="4705" height="2860" loading="lazy" /></a></p>

<p>This graph displays the modeled flight curve of <em>Pyronia tithonus</em> over the years. But the first year is “null”, probably a left-over of the 1st line with the header, and the week number is not shown.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-create-a-new-column-of-the-dataset-containing-the-week-and-the-year"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Create a new column of the dataset containing the week and the year</div>
  <ol>
    <li><strong>Count occurrences of each record</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“from dataset”</em>: output from <strong>Flight curve</strong></li>
        <li><em>“Select”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code> (the column with the year)</li>
        <li><em>“Delimited by”</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><em>“How should the results be sorted?”</em>: <code class="language-plaintext highlighter-rouge">By the values being counted</code></li>
      </ul>
    </li>
    <li>
      <p>Inspect and expand the output data from <strong>Count occurrences of each record</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>What can you see in this file?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <p>A list of the years and the number of occurrence for each year which should match the number of days for each year.</p>
        </blockquote>
      </blockquote>
    </li>
    <li><strong>Column Regex Find And Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output file from <strong>flight curve</strong>.</li>
        <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column 2</code> (the column with the year)</li>
        <li>Click on <em>“Insert Check”</em></li>
        <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">(20[0-9][0-9])</code></li>
        <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">-\1</code></li>
      </ul>
    </li>
    <li>Inspect the file and check if all the years are now written with a <code class="language-plaintext highlighter-rouge">-</code> before the digits.</li>
    <li><strong>Merge Columns together</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Select data”</em>: output from the last <strong>Column Regex Find And Replace</strong>.</li>
        <li><em>“Merge column”</em>: <code class="language-plaintext highlighter-rouge">Column: 3</code> (the column with the week)</li>
        <li><em>“with column”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code> (the column with the year)</li>
      </ul>
    </li>
    <li><strong>Column Regex Find And Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to recreate the original content for the year column:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output file from <strong>Merge Columns together</strong>.</li>
        <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column 2</code> (the column with the year)</li>
        <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">-(20[0-9][0-9])</code></li>
        <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">\1</code></li>
      </ul>
    </li>
    <li>
      <p><strong>Remove beginning of a file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> to remove first line (to avoid header in the visualization)</p>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-dataset-with-information-about-more-than-one-species"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Dataset with information about more than one species</div>
        <p>If your dataset contains information about more than one species, you can apply the previous steps and then run an extra-step to select one specific species and show all the data corresponding to it.</p>
      </blockquote>
    </li>
    <li>Generate the chart using the visualization with the x-axis corresponding to your column <code class="language-plaintext highlighter-rouge">"week""year"</code>.
      <ol>
        <li>Inspect and expand the output data from <strong>Remove beginning of a file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>Click on the <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>
        <li>Select <strong>Line chart (NVD3)</strong> as visualization type</li>
        <li>Give it a proper name, e.g. <code class="language-plaintext highlighter-rouge">Pyronia tithonus phenology simple vizu</code></li>
        <li>On <strong>Select data</strong> area, specify:
          <ul>
            <li><em>“Provide a label”</em>: <code class="language-plaintext highlighter-rouge">Pyronia tithonus phenology from 2003 to 2012</code> for example</li>
            <li><em>“Pick a series color”</em>: Choose a color for the line</li>
            <li><em>“Data point labels”</em>: <code class="language-plaintext highlighter-rouge">Column 6</code> (the nm column) or another one</li>
            <li><em>“Values for x-axis”</em>: <code class="language-plaintext highlighter-rouge">Column 7</code> (the “week-year” column)</li>
            <li><em>“Values for y-axis”</em>: <code class="language-plaintext highlighter-rouge">Column 6</code> (the nm column)</li>
          </ul>
        </li>
        <li>On <strong>Customize</strong>, specify:
          <ul>
            <li><em>“X-Axis label”</em>: <code class="language-plaintext highlighter-rouge">Week-Year</code></li>
            <li><em>“Y-Axis label”</em>: <code class="language-plaintext highlighter-rouge">nm values</code></li>
          </ul>
        </li>
        <li>Click on <strong>Save</strong></li>
      </ol>
    </li>
  </ol>

</blockquote>

<p><a href="../../images/regionalGAM/Pyronia_tithonus_phenology_explicit_ID.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/Pyronia_tithonus_phenology_explicit_ID.png" alt="Phenology chart. " width="4705" height="3105" loading="lazy" /></a></p>

<p>This shows the abundance of <em>Pyronia tithonus</em>, over the weeks. We can see there is a peak every year as expected and we can notice some differences in the values between the weeks and years, but not how the weeks overlap between the years. We will plot a stalked version of this visualization to check if there are no unexpected changes and have an idea of the quality of the reconstructed phenology.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-visualize-the-years-on-a-stacked-graph"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Visualize the years on a stacked graph</div>
  <ol>
    <li><strong>Scatterplot w ggplot2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“from dataset”</em>: output from <strong>Flight curve</strong></li>
        <li><em>“Column to plot on x-axis”</em>: <code class="language-plaintext highlighter-rouge">4</code> (the column with the year)</li>
        <li><em>“Column to plot on y-axis”</em>: <code class="language-plaintext highlighter-rouge">6</code></li>
        <li><em>“Plot title”</em>: add a meaningful title (e.g. <code class="language-plaintext highlighter-rouge">Pyronia tithonus phenology stacked visualization</code>)</li>
        <li><em>“Label for x axis”</em>: add a meaningful label (e.g. <code class="language-plaintext highlighter-rouge">Day number</code>)</li>
        <li><em>“Label for y axis”</em>: add a meaningful label  (e.g. <code class="language-plaintext highlighter-rouge">nm value</code>)</li>
        <li><em>“Type of plot”</em>: <code class="language-plaintext highlighter-rouge">Line only</code></li>
        <li><em>“Plotting multiple groups”</em>: <code class="language-plaintext highlighter-rouge">Plot multiple groups of data on one plot</code> to superimpose years</li>
        <li><em>“column differentiating the different groups”</em>: <code class="language-plaintext highlighter-rouge">2</code> to affect one coulor by year</li>
        <li><em>“Color schemes to differentiate your groups”</em>: <code class="language-plaintext highlighter-rouge">set 3</code> or any set of color with more than 10 colors as there are 10 years in our dataset.</li>
      </ul>
    </li>
  </ol>

</blockquote>

<p><a href="../../images/regionalGAM/Pyronia_tithonus_phenology_stacked_explicit_ID.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/Pyronia_tithonus_phenology_stacked_explicit_ID.png" alt="Stacked Phenology chart. " width="2700" height="2100" loading="lazy" /></a></p>

<p>With this graph, we can see that <em>Pyronia tithonus</em> records are always around the same weeks every year. We can also see small differences between years but overall the phenology is quite stable and the results of this step seem good and allow us to continue with the calculation of the abundance index.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-working-with-more-than-one-species"><button class="gtn-boxify-button details" type="button" aria-controls="details-working-with-more-than-one-species" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> Details: Working with more than one species<span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>If you are working with more than one species, you should follow the next steps</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on</div>
    <ol>
      <li><strong>Paste two files side by side</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
        <ul>
          <li><em>“Paste”</em>: <code class="language-plaintext highlighter-rouge">the output</code> from <strong>Merge Columns together</strong> (with the dataset for species 1)</li>
          <li><em>“and”</em>: <code class="language-plaintext highlighter-rouge">the output</code> from <strong>Merge Columns together</strong> (with the dataset for species 2)</li>
          <li><em>“Delimited by”</em>: tabulation</li>
        </ul>
      </li>
    </ol>

    <blockquote class="comment">

      <div class="box-title comment-title" id="comment-you-can-add-other-species"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: You can add other species.</div>
      <p>In order to do so you will have to do as explained below:</p>
      <ol>
        <li><strong>Paste two files side by side</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
          <ul>
            <li><em>“Paste”</em>: the <code class="language-plaintext highlighter-rouge">output</code> from <strong>Paste two files side by side</strong> (with the dataset containing species 1 and 2)</li>
            <li><em>“and”</em>: <code class="language-plaintext highlighter-rouge">the output</code> from <strong>Merge Columns together</strong> (with the dataset containing species 3)</li>
            <li><em>“Delimited by”</em>: tabulation</li>
          </ul>
        </li>
        <li>Repeat <strong>Paste two files side by side</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the output from <strong>Paste two files side by side</strong> (with the data containing species 1, 2 and 3) and with the output from <strong>Merge Columns together</strong> (with the dataset containing species 4) and so on.</li>
      </ol>
    </blockquote>
  </blockquote>

  <p>If your input dataset contains information about more than one species, you can now generate a chart for the multi-species dataset:</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on</div>
    <ol>
      <li>Inspect and expand the output data from <strong>flight curve</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      <li>Click on the <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> (<strong>Visualize</strong>) icon</li>
      <li>Select a visualization: <code class="language-plaintext highlighter-rouge">line chart (NVD3)</code></li>
      <li>Give it a proper name like <code class="language-plaintext highlighter-rouge">Aglais io &amp; Pyronia tithonus phenology</code></li>
      <li>Select data
        <ul>
          <li><em>“Provide a label”</em>: The name of the first species, for example <code class="language-plaintext highlighter-rouge">Aglais io</code></li>
          <li><em>“Pick a series color”</em>: Choose a color</li>
          <li><em>“Data point labels”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to the name of the species 1</code></li>
          <li><em>“Values for x-axis”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to the "week and year" of the species 1</code></li>
          <li><em>“Values for y-axis”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to nm of the species 1</code></li>
        </ul>
      </li>
      <li>Insert data series:
        <ul>
          <li>*“Provide a label”: he name of the second species, for example <code class="language-plaintext highlighter-rouge">Pyronia tithonus</code></li>
          <li><em>“Pick a series color”</em>: Choose a different color</li>
          <li><em>“Data point labels”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to the name of the species 2</code></li>
          <li><em>“Values for x-axis”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to the "week and year" of the species 2</code></li>
          <li><em>“Values for y-axis”</em>: <code class="language-plaintext highlighter-rouge">Column corresponding to nm of the species 2</code></li>
        </ul>
      </li>
      <li>You may repeat “Insert data series” as many times as needed depending on the number of different species you want to represent on your chart.</li>
      <li>Click on <strong>Customize</strong>
        <ul>
          <li><em>“X-Axis label”</em>: <code class="language-plaintext highlighter-rouge">Week and Year</code></li>
          <li><em>“Y-Axis label”</em>: <code class="language-plaintext highlighter-rouge">nm values</code></li>
          <li><em>“Use multi-panels”</em>: click on <code class="language-plaintext highlighter-rouge">No</code>(or you will have separated charts, one for each species)</li>
        </ul>
      </li>
      <li>Click on <strong>Save</strong> if you are willing to keep it</li>
    </ol>

  </blockquote>

</blockquote>

<h2 id="compute-abundance-index-across-sites-and-years">Compute Abundance Index across sites and years</h2>

<p>We now would like to create a file showing the abundance index per year of a chosen species in a certain site.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-generate-an-abundance-index"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Generate an abundance index</div>
  <ol>
    <li><strong>Abundance index</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><em>“Count file”</em>: output from <strong>Text reformatting with awk</strong>, that should be named <code class="language-plaintext highlighter-rouge">Counting file</code> and/or tagged <code class="language-plaintext highlighter-rouge">Count</code></li>
        <li><em>“Flight curve output”</em>: output from <strong>flight curve</strong></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><strong>Abundance index</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> generates a table with 5 columns:</p>
<ul>
  <li>Site</li>
  <li>Species</li>
  <li>Year</li>
  <li>Regional GAM</li>
  <li>prop_pheno_sampled</li>
</ul>

<h2 id="compute-a-collated-index-for-each-year-and-estimates-the-temporal-trend">Compute a collated index for each year and estimates the temporal trend</h2>

<p>The expected temporal trend allows you to have an overview of the evolution of a species in a certain type of environment in the future.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-expected-temporal-trend"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Expected temporal trend</div>
  <ol>
    <li><strong>Expected temporal trend</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><em>“Tabular file generated by the ab_index tool”</em>: output of <strong>abundance index</strong></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><strong>Expected temporal trend</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> generates 2 files”</p>
<ol>
  <li>
    <p>The graph like:</p>

    <p><a href="../../images/regionalGAM/Expected_temporal_trend.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/Expected_temporal_trend.png" alt="Expected temporal trend. " width="480" height="480" loading="lazy" /></a></p>
  </li>
  <li>
    <p>A table with values of “x”, the collated index value by year</p>
  </li>
</ol>

<p>Sometimes the expected temporal trend can’t be done on dataset. If you want this action to work, the occurrences on your dataset must lie between the month of April and the end of the month of September.</p>

<h2 id="model-temporal-trend">Model temporal trend</h2>

<p>We would like to know if the year has an influence on the abundance of a species. We will use a linear regression to do that.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-more-details-about-the-statistics"><button class="gtn-boxify-button details" type="button" aria-controls="details-more-details-about-the-statistics" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> Details: More details about the statistics<span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>The model fitted to the data is:
\(Y_i = \alpha + \beta x_i + \epsilon_i\)
with \(Y_i\) = value of the dependent variable for the unit \(i\)
\(\alpha\) = intercept
\(\beta\) = slope
\(x_i\) = value of the explanatory variable for the unit \(i\)
\(e_i\) = residual for the unit \(i\)</p>

</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-model-temporal-trend-with-linear-regression"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Model temporal trend with linear regression</div>
  <ol>
    <li><strong>Model temporal trend with a simple linear regression</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File generated by the glmmpql/Expected temporal trend tool”</em>: tabular output of <strong>temporal trend</strong></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>Have a look at the text file result. This is the output of the linear model.</p>

<p><a href="../../images/regionalGAM/output-simple-linear-regression.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/output-simple-linear-regression.png" alt="Output from the &quot;model temporal trend with simple linear regression&quot; tool . " width="1669" height="826" loading="lazy" /></a></p>

<p>Details about the output from the tool</p>

<ol>
  <li>The formula of the model following this format: “Model : dependent variable ~ explanatory variable”</li>
  <li>The estimated values of the coefficients</li>
  <li>The standard error of the coefficients</li>
  <li>The value of the “hypothesis test statistic”</li>
  <li>The probability value.</li>
</ol>

<blockquote class="question">
  <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>What are the estimates of the regression coefficients?</li>
    <li>Can we use this model to make good predictions?</li>
    <li>Is the test p-value significant?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>Intercept is 183.33852 and the slope (Year) is -0.08952.</li>
      <li>No, the residual standard error is high.</li>
      <li>Yes (0.0282 &lt; 0.05).</li>
    </ol>

  </blockquote>
</blockquote>

<p>We can also test for autocorrelation in the data.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-check-if-there-is-autocorrelation-of-residuals"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Check if there is autocorrelation of residuals</div>
  <ol>
    <li><strong>Autocorrelation test check for temporal autocorrelation in the residuals</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“gls model”</em>: tabular output of <strong>Model temporal trend</strong></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><a href="../../images/regionalGAM/Autocorrelation_test.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/Autocorrelation_test.png" alt="Autocorrelation test graph. " width="480" height="480" loading="lazy" /></a></p>

<p>Have a look at this plot. We can see that one of the value is above the threshold (blue dashed line), therefore we observe autocorrelation in the data. We will now take into account the autocorrelation in the next model.</p>

<h2 id="take-into-account-the-autocorrelation">Take into account the autocorrelation</h2>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-model-temporal-trend-taking-into-account-autocorrelation-of-residuals"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Model temporal trend taking into account autocorrelation of residuals</div>
  <ol>
    <li><strong>Linear regression ajusted for autocorrelation in the residuals</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File generated by the glmmpql/Expected temporal trend tool”</em>: tabular output of <strong>temporal trend</strong></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>For this step you can use the scratchbook function in order to see the results of both models at the same time.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-how-to-use-the-scratchbook"><button class="gtn-boxify-button details" type="button" aria-controls="details-how-to-use-the-scratchbook" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> Details: How to use the scratchbook<span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>You can follow this tutorial if you want to learn how to use the scratchbook.
https://usegalaxy.org/tours/core.scratchbook</p>

</blockquote>

<p><a href="../../images/regionalGAM/output-both-models.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/output-both-models.png" alt="Plot of temporal trend with trend line. " width="1308" height="527" loading="lazy" /></a></p>

<p>Here you can compare the models using the AIC for Akaike information criterion. We can see that the AIC is lower in the model taking the autocorrelation into account. A lower AIC value is associated with less information loss.
We will therefore, based on the AIC, select the model taking into account the autocorrelation.
We can now represent the data with the trend line from the model.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-plot-the-data-and-the-trend-line-from-the-model"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Plot the data and the trend line from the model</div>
  <ol>
    <li><strong>Plot abundance with trend line</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File generated by the ab_index tool”</em>: output from <strong>abundance index</strong></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>“gls model”</em>: outputs of <strong>Model temporal trend with a simple linear regression</strong>.</li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><a href="../../images/regionalGAM/trend_simple.png" rel="noopener noreferrer"><img src="../../images/regionalGAM/trend_simple.png" alt="Plot of temporal trend with trend line. " width="480" height="480" loading="lazy" /></a></p>

<p>You can see the trends is an apparent decrease. Here results are statistically significant so we can say that there is a significant decrease of the abundance.</p>

<h1 id="conclusions">Conclusions</h1>

<p>In this tutorial, you have analyzed regional GAM data to extract useful information in order to be able to show different tendencies of a chosen species. Therefore, you are now able to treat the dataset so that it shows only the data for one specific species of your choice. From there, you can show the phenology of this species through the years first on a dataset and then on a visual chart. You have also learned how to represent on a single chart the phenology of various species. Afterwards, we have shown you how to create a dataset containing the information on the abundance of a species per year and per site. Based on which you can henceforth visually represent the annual abundance trend on a chart. Thereafter, you have the possibility of showing the expected temporal trend, based on which you will be able to assess the abundance of species. The last part of this tutorial has shown you how to calculate the linear regression allowing you to determinate whether the year has an influence on the abundance of a species or not.</p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>We sequentially computed phenology, abundance index, trend and model this trend</p>
</li>
                        
                        <li><p>We learned how to interpret a trend using modeling and data visualization</p>
</li>
                        
                        <li><p>This tool compute phenology in order to predict missing data, no definitive conclusion can be made on the phenology using this tool</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/ecology/faqs/">FAQ page for the Ecology topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/ecology#references">here</a>.</p>
                


                

                

                <h1>Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Regional GAM (Ecology)" alt="Feedback form link">
                    <img src="/training-material/shared/images/feedback.png" alt="Preview of the google form" />
                </a>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Clara Urfer, Elisa Michon, Yvan Le Bras, Bérénice Batut, Simon Benateau,  <b>Regional GAM (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html">https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{ecology-regionalGAM,
author = "Clara Urfer and Elisa Michon and Yvan Le Bras and Bérénice Batut and Simon Benateau",
	title = "Regional GAM (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/ecology/tutorials/regionalGAM/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

                


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="agenda follow-up" id="admins-install-missing-tools">
                    <div class="box-title">Galaxy Administrators: Install the missing tools</div>
			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/regionalGAM/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: text_processing
  owner: bgruening
  revisions: 9ff72e942410
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_ab_index
  owner: ecology
  revisions: d0ee713d4758
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_autocor_acf
  owner: ecology
  revisions: b416a363a2d5
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_flight_curve
  owner: ecology
  revisions: fff507f00b2b
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_glmmpql
  owner: ecology
  revisions: f3e1b6d244a6
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_gls
  owner: ecology
  revisions: a79f5f0f17ad
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam_plot_trend
  owner: ecology
  revisions: 58ecd15e6836
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regex_find_replace
  owner: galaxyp
  revisions: 209b7c5ee9d7
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: ggplot2_point
  owner: iuc
  revisions: 9cec81e1b90e
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: csv_to_tabular
  owner: mnhn65mo
  revisions: b735ac78702b
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: regionalgam
  owner: mnhn65mo
  revisions: 0e7066603eab
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: tabular_to_csv
  owner: mnhn65mo
  revisions: f1b7d0032530
  tool_panel_section_label: Ecology
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		


                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-6" style="text-align: left">
				<p>
					The <a href="https://galaxyproject.org/teach/gtn/">Galaxy Training Network</a>
					provides researchers with online training materials, connects them with local trainers, and helps promoting FAIR and Open Science practices worldwide. All contributions are subject to the <a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Galaxy Project Code of Conduct</a>.
				</p>
				<p>
				The GTN infrastructure is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
				</p>
				<p>
				Revision <a href="https://github.com/galaxyproject/training-material/commit/ee51c939937f9893c63a0f9494eaef0bfbfa1c6d">ee51c93</a>, built with Jekyll (4.3.2 | production)
				</p>
			</div>
			<div class="col-sm-6" style="text-align: right">
				
				<p>
					Resource <i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00134">https://gxy.io/GTN:T00134</a>
				</p>
				
				<p>
					<i>This Material</i>:
					
					is licensed under
					<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
						Creative Commons Attribution 4.0 International License
					</a>
				</p>
				<p>
					<a href="https://github.com/galaxyproject/training-material/edit/main/topics/ecology/tutorials/regionalGAM/tutorial.md" title="Edit on GitHub">
					<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
					</a>
				</p>
			</div>
		</div>
	</div>
</footer>


    </div>
</footer>


        <script src='/training-material/assets/js/bundle.main.js?v=1707351988'></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>