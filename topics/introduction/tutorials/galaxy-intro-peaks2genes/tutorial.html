<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>From peaks to genes</title>
        
            <!--
<script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
-->
<!-- We let users opt-out, so if they've opted in, we need to append the plausible script to the body -->

<script>
var scriptElement = document.createElement("script");
scriptElement.async = true;
scriptElement.defer = true;
scriptElement.setAttribute("data-domain", "training.galaxyproject.org");
scriptElement.src = "https://plausible.galaxyproject.eu/js/plausible.js";

// Appending the script element to the body
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Plausible: opt-in");
	// Wait for the document to be available
	document.addEventListener("DOMContentLoaded", function(event) {
		document.body.appendChild(scriptElement);
	});
}
</script>

<!-- JavaScript Error Monitoring, and performance tracking. -->
<!--
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
-->
<script type="text/javascript">
var scriptElement = document.createElement("script");
scriptElement.src = "https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js";
scriptElement.integrity = "sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43";
scriptElement.crossOrigin = "anonymous";

if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	// Appending the script element to the body
	document.addEventListener("DOMContentLoaded", function(event) {
		document.body.appendChild(scriptElement);
	});
		
	Sentry.init({
	  dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
	  release: "galaxy-training-network@ee51c939937f9893c63a0f9494eaef0bfbfa1c6d",
	  integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
	  sampleRate: 0.1,
	  tracesSampleRate: 0.1,
	  // Capture Replay for no sessions by default
	  replaysSessionSampleRate: 0.01,
	  // plus for 1% of sessions with an error
	  replaysOnErrorSampleRate: 0.01,
	  // PII OFF
	  sendDefaultPii: false, // Off by default but just in case.
	  environment: "production",
	});
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.js?v=1703464120' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.js?v=1703464120' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>


        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="From peaks to genes">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2023-02-02 12:11:01 +0000">
<meta name="DC.creator" content="Anne Pajon">
<meta name="DC.creator" content="Clemens Blank">
<meta name="DC.creator" content="Bérénice Batut">
<meta name="DC.creator" content="Björn Grüning">
<meta name="DC.creator" content="Nicola Soranzo">
<meta name="DC.creator" content="Dilmurat Yusuf">
<meta name="DC.creator" content="Sarah Peter">
<meta name="DC.creator" content="Helena Rasche">

        
        
        
        
        <meta name="description" content="Galaxy is a scientific workflow, data integration, and da...">
        <meta property="og:site_name" content="Galaxy Training Network">
        <meta property="og:title" content="Galaxy Training: From peaks to genes">
        <meta property="og:description" content="Galaxy is a scientific workflow, data integration, and da...">
        
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png">

        
        <script type="application/ld+json">
            


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "2023-02-02 12:11:01 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "From peaks to genes",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "identifier": "https://github.com/galaxyproject/training-material",
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Introduction to Galaxy Analyses",
    "description": "Galaxy is a scientific workflow, data integration, and data and analysis persistence and publishing platform that aims to make computational biology accessible to research scientists that do not have computer programming experience. ",
    "url": "https://training.galaxyproject.org/training-material/topics/introduction/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'From peaks to genes' tutorial",
  "url": "https://training.galaxyproject.org/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html",
  "timeRequired": "PT3H",
  "teaches": "Familiarize yourself with the basics of Galaxy\n - Learn how to obtain data from external sources\n - Learn how to run tools\n - Learn how histories work\n - Learn how to create a workflow\n - Learn how to share your work",
  "keywords": "introduction",
  "description": "The questions this  addresses are:\n - How to use Galaxy?\n - How to get from peak regions to a list of gene names?\n\n\nThe objectives are:\n - Familiarize yourself with the basics of Galaxy\n - Learn how to obtain data from external sources\n - Learn how to run tools\n - Learn how histories work\n - Learn how to create a workflow\n - Learn how to share your work\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/pajanne/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/pajanne/",
      "name": "Anne Pajon",
      "image": "https://avatars.githubusercontent.com/pajanne",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/blankclemens/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/blankclemens/",
      "name": "Clemens Blank",
      "image": "https://avatars.githubusercontent.com/blankclemens",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-1726-2256",
      "orcid": "https://orcid.org/0000-0002-1726-2256"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "name": "Bérénice Batut",
      "image": "https://avatars.githubusercontent.com/bebatut",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9852-1987",
      "orcid": "https://orcid.org/0000-0001-9852-1987"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/",
      "name": "Björn Grüning",
      "image": "https://avatars.githubusercontent.com/bgruening",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-3079-6586",
      "orcid": "https://orcid.org/0000-0002-3079-6586"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/nsoranzo/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/nsoranzo/",
      "name": "Nicola Soranzo",
      "image": "https://avatars.githubusercontent.com/nsoranzo",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-3627-5340",
      "orcid": "https://orcid.org/0000-0003-3627-5340"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/dyusuf/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/dyusuf/",
      "name": "Dilmurat Yusuf",
      "image": "https://avatars.githubusercontent.com/dyusuf",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/sarah-peter/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/sarah-peter/",
      "name": "Sarah Peter",
      "image": "https://avatars.githubusercontent.com/sarah-peter",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "name": "Helena Rasche",
      "image": "https://avatars.githubusercontent.com/hexylena",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "url": "https://galaxyproject.org/teach/gtn/"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9760-8992",
      "orcid": "https://orcid.org/0000-0001-9760-8992"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Introduction to Galaxy Analyses",
      "description": "Galaxy is a scientific workflow, data integration, and data and analysis persistence and publishing platform that aims to make computational biology accessible to research scientists that do not have computer programming experience. ",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [

  ],
  "abstract": "# Introduction"
}
        </script>
        
    </head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script src='/training-material/assets/js/bundle.theme.js?v=1703464120'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/introduction" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Introduction to Galaxy Analyses
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        <a class="dropdown-item" href="/training-material/topics/introduction/faqs/" title="Check our FAQs for the Introduction to Galaxy Analyses topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                    <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

		<a href="/training-material/preferences.html" class="dropdown-item">
			<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Themes have moved <span class="badge badge-secondary">New</span>
		</a>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-introduction">
    <h1 data-toc-skip>From peaks to genes</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/pajanne/" class="contributor-badge contributor-pajanne"><img src="https://avatars.githubusercontent.com/pajanne?s=36" alt="Avatar" width="36" height="36">Anne Pajon</a><a href="/training-material/hall-of-fame/blankclemens/" class="contributor-badge contributor-blankclemens"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/blankclemens?s=36" alt="Avatar" width="36" height="36">Clemens Blank</a><a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Avatar" width="36" height="36">Bérénice Batut</a><a href="/training-material/hall-of-fame/bgruening/" class="contributor-badge contributor-bgruening"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bgruening?s=36" alt="Avatar" width="36" height="36">Björn Grüning</a><a href="/training-material/hall-of-fame/nsoranzo/" class="contributor-badge contributor-nsoranzo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/nsoranzo?s=36" alt="Avatar" width="36" height="36">Nicola Soranzo</a><a href="/training-material/hall-of-fame/dyusuf/" class="contributor-badge contributor-dyusuf"><img src="https://avatars.githubusercontent.com/dyusuf?s=36" alt="Avatar" width="36" height="36">Dilmurat Yusuf</a><a href="/training-material/hall-of-fame/sarah-peter/" class="contributor-badge contributor-sarah-peter"><img src="https://avatars.githubusercontent.com/sarah-peter?s=36" alt="Avatar" width="36" height="36">Sarah Peter</a><a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Avatar" width="36" height="36">Helena Rasche</a>
	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>How to use Galaxy?</p>
</li>
        
        <li><p>How to get from peak regions to a list of gene names?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Familiarize yourself with the basics of Galaxy</p>
</li>
        
        <li><p>Learn how to obtain data from external sources</p>
</li>
        
        <li><p>Learn how to run tools</p>
</li>
        
        <li><p>Learn how histories work</p>
</li>
        
        <li><p>Learn how to create a workflow</p>
</li>
        
        <li><p>Learn how to share your work</p>
</li>
        
        </ul>

        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 3 hours</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://doi.org/10.5281/zenodo.1025586">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/workflows/" title="From peaks to genes workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            













  



            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
	<li class="dropdown-header">
		<b>Known Working</b>
	</li>
	
	

    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> ⭐️
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.fr/" title="">
			UseGalaxy.fr <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> ⭐️
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.no/" title="">
			UseGalaxy.no <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> ⭐️
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.org" title="">
			UseGalaxy.org (Main) <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> ⭐️
		</a>
	</li>
    
    
    
    
	<li class="dropdown-header">
		<b>Possibly Working</b>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.be/" title="">
			UseGalaxy.be
		</a>
	</li>
    
    

    
	<li class="dropdown-header">
		Containers
	</li>
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics//docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Feb 2, 2023 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Tutorial Content is licensed under Creative Commons Attribution 4.0 International License</a>.
             The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00189">https://gxy.io/GTN:T00189</a> </div>
        
    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <h1 id="introduction">Introduction</h1>

<p>We stumbled upon a paper (<span class="citation"><a href="#Li2012">Li <i>et al.</i> 2012</a></span>) called <em>“The histone acetyltransferase MOF is a key regulator of the embryonic stem cell core transcriptional network”</em>. The paper contains the analysis of possible target genes of an interesting protein called Mof. The targets were obtained by ChIP-seq in mice and the raw data is available through <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE37268">GEO</a>.
However, the list of genes is neither in the supplement of the paper, nor part of the GEO submission.
The closest thing we could find is a file in GEO containing a list of the regions where the signal is significantly enriched (so called <em>peaks</em>):</p>

<table>
  <tbody>
    <tr>
      <td>1</td>
      <td>3660676</td>
      <td>3661050</td>
      <td>375</td>
      <td>210</td>
      <td>62.0876250438913</td>
      <td>-2.00329386666667</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3661326</td>
      <td>3661500</td>
      <td>175</td>
      <td>102</td>
      <td>28.2950833625942</td>
      <td>-0.695557142857143</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3661976</td>
      <td>3662325</td>
      <td>350</td>
      <td>275</td>
      <td>48.3062708406486</td>
      <td>-1.29391285714286</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3984926</td>
      <td>3985075</td>
      <td>150</td>
      <td>93</td>
      <td>34.1879823073944</td>
      <td>-0.816992</td>
    </tr>
    <tr>
      <td>1</td>
      <td>4424801</td>
      <td>4424900</td>
      <td>100</td>
      <td>70</td>
      <td>26.8023246007435</td>
      <td>-0.66282</td>
    </tr>
  </tbody>
</table>

<p><strong>Table 1</strong> Subsample of the available file</p>

<p>The goal of this exercise is to <strong>turn this list of genomic regions into a list of possible target genes</strong>.</p>

<!--SNIPPET-->
<blockquote class="comment">   <div class="box-title comment-title" id="comment-results-may-vary"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Results may vary</div>   <p>Your results may be slightly different from the ones presented in this tutorial due to differing versions of tools, reference data, external databases, or because of stochastic processes in the algorithms.</p> </blockquote>
<p><!--END_SNIPPET--></p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#pretreatments" id="markdown-toc-pretreatments">Pretreatments</a>    <ol>
      <li><a href="#data-upload" id="markdown-toc-data-upload">Data upload</a></li>
    </ol>
  </li>
  <li><a href="#part-1-naive-approach" id="markdown-toc-part-1-naive-approach">Part 1: Naive approach</a>    <ol>
      <li><a href="#file-preparation" id="markdown-toc-file-preparation">File preparation</a></li>
      <li><a href="#analysis" id="markdown-toc-analysis">Analysis</a></li>
      <li><a href="#visualization" id="markdown-toc-visualization">Visualization</a></li>
      <li><a href="#extracting-workflow" id="markdown-toc-extracting-workflow">Extracting workflow</a></li>
    </ol>
  </li>
  <li><a href="#part-2-more-sophisticated-approach" id="markdown-toc-part-2-more-sophisticated-approach">Part 2: More sophisticated approach</a>    <ol>
      <li><a href="#preparation" id="markdown-toc-preparation">Preparation</a></li>
      <li><a href="#create-peak-summit-file" id="markdown-toc-create-peak-summit-file">Create peak summit file</a></li>
      <li><a href="#get-gene-names" id="markdown-toc-get-gene-names">Get gene names</a></li>
      <li><a href="#repeat-workflow" id="markdown-toc-repeat-workflow">Repeat workflow</a></li>
    </ol>
  </li>
  <li><a href="#share-your-work" id="markdown-toc-share-your-work">Share your work</a></li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h1 id="pretreatments">Pretreatments</h1>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-open-galaxy"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Open Galaxy</div>

  <ol>
    <li>Browse to a Galaxy instance: the one recommended by your instructor or one in the list <strong>Galaxy instance</strong> on the head of this page</li>
    <li>
      <p>Log in or register (top panel)</p>

      <p><a href="../../images/login_register.png" rel="noopener noreferrer"><img src="../../images/login_register.png" alt="Login or Register on the top panel. " width="725" height="109" loading="lazy" /></a></p>
    </li>
  </ol>
</blockquote>

<p>The Galaxy interface consist of three main parts. The available tools are listed on the left, your analysis history is recorded on the right, and the central panel will show the tools and datasets.</p>

<p><a href="../../images/galaxy_interface.png" rel="noopener noreferrer"><figure id="figure-1" style="max-width: 90%; margin:auto;"><img src="../../images/galaxy_interface.png" alt="Galaxy interface screenshot showing history panel on the right, tools panel on the left, and main panel at the center. " width="1777" height="1290" loading="lazy" />&lt;figcaption&gt;<span class="figcaption-prefix"><strong>Figure 1</strong>:</span> The Galaxy interface&lt;/figcaption&gt;</figure></a></p>

<p>Let’s start with a fresh history.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-create-history"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Create history</div>

  <ol>
    <li>
      <p>Make sure you have an empty analysis history.</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Creating a new history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>   <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>   <ol>   <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>   <li>Select the option <strong>Create New</strong> from the menu</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p><strong>Rename your history</strong> to make it easy to recognize</p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-rename-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-rename-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> Tip: Rename a history<span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ul>
          <li>
            <p>Click on the title of the history (by default the title is <code class="language-plaintext highlighter-rouge">Unnamed history</code>)</p>

            <p><a href="../../../../shared/images/rename_history.png" rel="noopener noreferrer"><img src="../../../../shared/images/rename_history.png" alt="Renaming history. " width="270" height="320" loading="lazy" /></a></p>
          </li>
          <li>Type <code class="language-plaintext highlighter-rouge">Galaxy Introduction</code> as the name</li>
          <li>Press <kbd>Enter</kbd></li>
        </ul>

      </blockquote>
    </li>
  </ol>

</blockquote>

<h2 id="data-upload">Data upload</h2>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload</div>

  <ol>
    <li>Download the list of peak regions (the file <a href="https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE37268&amp;format=file&amp;file=GSE37268%5Fmof3%2Eout%2Ehpeak%2Etxt%2Egz"><code class="language-plaintext highlighter-rouge">GSE37268_mof3.out.hpeak.txt.gz</code></a>) from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE37268">GEO</a> to your computer</li>
    <li>
      <p>Click on the upload button in the upper left of the interface</p>

      <p><a href="../../../galaxy-interface/images/upload_button.png" rel="noopener noreferrer"><img src="../../../galaxy-interface/images/upload_button.png" alt="Upload data icon. " width="313" height="177" loading="lazy" /></a></p>
    </li>
    <li>Press <strong>Choose local files</strong> and search for your file on your computer</li>
    <li>Select <code class="language-plaintext highlighter-rouge">interval</code> as <strong>Type</strong></li>
    <li>Press <strong>Start</strong></li>
    <li>Press <strong>Close</strong></li>
    <li>
      <p>Wait for the upload to finish. Galaxy will automatically unpack the file.</p>
    </li>
    <li>
      <p>After this you will see your first history item in Galaxy’s right pane. It will go through
the gray (preparing/queued) and yellow (running) states to become green (success):</p>

      <p><a href="../../images/intro_01.png" rel="noopener noreferrer"><img src="../../images/intro_01.png" alt="History section. " width="249" height="94" loading="lazy" /></a></p>

      <p>Directly uploading files is not the only way to get data into Galaxy</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing via links<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Type (set all):</strong> from “Auto-detect” to <code class="language-plaintext highlighter-rouge">interval</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-importing-data-to-galaxy"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-to-galaxy" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> Tip: Importing data to Galaxy<span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>There are <a href="/training-material/topics/galaxy-interface/tutorials/get-data/slides.html">more options</a> for advanced users.</p>
      </blockquote>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-interval-file-format"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Interval file format</div>
  <p><strong>Interval</strong> format is a Galaxy format for representing genomic intervals. It is tab-separated, but has the added requirement that three of the columns must be:</p>
  <ul>
    <li>chromosome ID</li>
    <li>start position (0-based)</li>
    <li>end position (end-exclusive)</li>
  </ul>

  <p>An optional strand column can also be specified, and an initial header row can be used to label the columns, which do not have to be in any special order. Unlike BED format (see below) arbitrary additional columns can also be present.</p>

  <p>You can find more information about formats that can be used in Galaxy at the <a href="https://usegalaxy.org/static/formatHelp.html">Galaxy Data Formats page</a>.</p>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-inspect-and-edit-attributes-of-a-file"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect and edit attributes of a file</div>

  <ol>
    <li>
      <p>Click on the file in the history panel</p>

      <p>Some meta-information (e.g. format, reference database) about the file and the header of the file are then displayed, along with the number of lines in the file (48,647):</p>

      <p><a href="../../images/input_expanded_file.png" rel="noopener noreferrer"><img src="../../images/input_expanded_file.png" alt="Expanded file in history. " width="249" height="334" loading="lazy" /></a></p>
    </li>
    <li>
      <p>Click on the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon (<strong>View data</strong>) in your dataset in the history</p>

      <p>The content of the file is displayed in the central panel</p>
    </li>
    <li>
      <p>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (pencil) icon (<strong>Edit attributes</strong>) in your dataset in the history</p>

      <p>A form to edit dataset attributes is displayed in the central panel</p>
    </li>
    <li>
      <p>Search for <code class="language-plaintext highlighter-rouge">mm9</code> in <strong>Database/Build</strong> attribute and select <code class="language-plaintext highlighter-rouge">Mouse July 2007 (NCBI37/mm9)</code> (the paper tells us the peaks are from <code class="language-plaintext highlighter-rouge">mm9</code>)</p>

      <p><a href="../../images/Search-for-mm9.PNG" rel="noopener noreferrer"><img src="../../images/Search-for-mm9.PNG" alt="The database/build version can be selected from a dropdown menu. Users can start typing the database name to filter the list. " width="1154" height="162" loading="lazy" /></a></p>
    </li>
    <li>Click on <strong>Save</strong> on the top</li>
    <li>
      <p>Add a tag called <code class="language-plaintext highlighter-rouge">#peaks</code> to the dataset to make it easier to track in the history</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-adding-a-tag"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-adding-a-tag" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Adding a tag<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on the dataset to expand it</li>   <li>Click on <strong>Add Tags</strong> <i class="fas fa-tags" aria-hidden="true"></i><span class="visually-hidden">galaxy-tags</span></li>   <li>Add a tag  starting with <code class="language-plaintext highlighter-rouge">#</code>     <ul>       <li>Tags starting with <code class="language-plaintext highlighter-rouge">#</code> will be automatically propagated to the outputs of tools using this dataset.</li>     </ul>   </li>   <li>Press <kbd>Enter</kbd></li>   <li>Check that the tag appears below the dataset name</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>

      <p>The dataset should now look like below in the history</p>

      <p><a href="../../images/input_tagged_file.png" rel="noopener noreferrer"><img src="../../images/input_tagged_file.png" alt="Peaks file. " width="234" height="312" loading="lazy" /></a></p>
    </li>
  </ol>

</blockquote>

<p>In order to find the related genes to these peak regions,
we also need a list of genes in mice, which we can obtain from UCSC.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload-from-ucsc"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload from UCSC</div>

  <ol>
    <li>
      <p>Search for <code class="language-plaintext highlighter-rouge">UCSC Main</code> in the tool search bar (top left)</p>

      <p><a href="../../images/101_01.png" rel="noopener noreferrer"><img src="../../images/101_01.png" alt="UCSC Main tool in tools section. " width="346" height="160" loading="lazy" /></a></p>
    </li>
    <li>
      <p>Click on <code class="language-plaintext highlighter-rouge">UCSC Main</code> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></p>

      <p>You will be taken to the <strong>UCSC table browser</strong>, which looks something like this:</p>

      <p><a href="../../images/intro_02.png" rel="noopener noreferrer"><img src="../../images/intro_02.png" alt="UCSC table browser interface. " width="1342" height="583" loading="lazy" /></a></p>
    </li>
    <li>Set the following options:
      <ul>
        <li><em>“clade”</em>: <code class="language-plaintext highlighter-rouge">Mammal</code></li>
        <li><em>“genome”</em>: <code class="language-plaintext highlighter-rouge">Mouse</code></li>
        <li><em>“assembly”</em>: <code class="language-plaintext highlighter-rouge">July 2007 (NCBI37/mm9)</code></li>
        <li><em>“group”</em>: <code class="language-plaintext highlighter-rouge">Genes and Gene Predictions</code></li>
        <li><em>“track”</em>: <code class="language-plaintext highlighter-rouge">RefSeq Genes</code></li>
        <li><em>“table”</em>: <code class="language-plaintext highlighter-rouge">refGene</code></li>
        <li><em>“region”</em>: <code class="language-plaintext highlighter-rouge">genome</code></li>
        <li><em>“output format”</em>: <code class="language-plaintext highlighter-rouge">BED - browser extensible data</code></li>
        <li><em>“Send output to”</em>: <code class="language-plaintext highlighter-rouge">Galaxy</code> (only)</li>
      </ul>
    </li>
    <li>
      <p>Click on the <strong>get output</strong> button</p>

      <p>You will see the next screen:</p>

      <p><a href="../../images/intro_03.png" rel="noopener noreferrer"><img src="../../images/intro_03.png" alt="Output settings. " width="751" height="484" loading="lazy" /></a></p>
    </li>
    <li>Make sure that <em>“Create one BED record per”</em> is set to <code class="language-plaintext highlighter-rouge">Whole Gene</code></li>
    <li>Click on the <strong>Send Query to Galaxy</strong> button</li>
    <li>Wait for the upload to finish</li>
    <li>
      <p>Rename our dataset to something more recognizable like <code class="language-plaintext highlighter-rouge">Genes</code></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-dataset"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-dataset" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Renaming a dataset<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class="language-plaintext highlighter-rouge">Genes</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>Add a tag called <code class="language-plaintext highlighter-rouge">#genes</code> to the dataset to make it easier to track in the history</li>
  </ol>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-bed-file-format"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: BED file format</div>
  <p>The <strong>BED - Browser Extensible Data</strong> format provides a flexible way to encode gene regions. BED lines have three required fields:</p>
  <ul>
    <li>chromosome ID</li>
    <li>start position (0-based)</li>
    <li>end position (end-exclusive)</li>
  </ul>

  <p>There can be up to and nine additional optional fields, but the number of fields per line must be consistent throughout any single set of data.</p>

  <p>You can find more information about it at <a href="https://genome.ucsc.edu/FAQ/FAQformat#format1">UCSC</a> including a description of the optional fields.</p>
</blockquote>

<p>Now we have collected all the data we need to start our analysis.</p>

<h1 id="part-1-naive-approach">Part 1: Naive approach</h1>

<p>We will first use a “naive” approach to try to identify the genes that the peak regions are associated with. We will identify genes that overlap at least 1bp with the peak regions.</p>

<h2 id="file-preparation">File preparation</h2>

<p>Let’s have a look at our files to see what we actually have here.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-view-file-content"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: View file content</div>

  <ol>
    <li>
      <p>Click on the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon (<strong>View data</strong>) of the peak file to view the content of it</p>

      <p>It should look like this:</p>

      <p><a href="../../images/intro_04.png" rel="noopener noreferrer"><img src="../../images/intro_04.png" alt="Contents of the peak file. " width="626" height="301" loading="lazy" /></a></p>
    </li>
    <li>
      <p>View the content of the regions of the genes from UCSC</p>

      <p><a href="../../images/intro_05.png" rel="noopener noreferrer"><img src="../../images/intro_05.png" alt="Contents of UCSC file. " width="1111" height="429" loading="lazy" /></a></p>
    </li>
  </ol>

</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>While the file from UCSC has labels for the columns, the peak file does not. Can you guess what the columns stand for?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>This peak file is not in any standard format and just by looking at it, we cannot find out what the numbers in the different columns mean. In the paper the authors mention that they used the peak caller <a href="https://www.ncbi.nlm.nih.gov/pubmed/20598134">HPeak</a>.</p>

    <p>By looking at the HPeak manual we can find out that the columns contain the following information:</p>

    <ul>
      <li>chromosome name by number</li>
      <li>start coordinate</li>
      <li>end coordinate</li>
      <li>length</li>
      <li>location within the peak that has the highest hypothetical DNA fragment coverage (summit)</li>
      <li>not relevant</li>
      <li>not relevant</li>
    </ul>

  </blockquote>
</blockquote>

<p>In order to compare the two files, we have to make sure that the chromosome names follow the same format.
As we can see, the peak file lacks <code class="language-plaintext highlighter-rouge">chr</code> before any chromosome number. But what happens with chromosome 20 and 21? Will it be X and Y instead? Let’s check:</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-view-end-of-file"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: View end of file</div>

  <ol>
    <li>Search for <strong>Select last</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> tool and run <strong>Select last lines from a dataset (tail)</strong> with the following settings:
      <ul>
        <li><em>“Text file”</em>: our peak file <code class="language-plaintext highlighter-rouge">GSE37268_mof3.out.hpeak.txt.gz</code></li>
        <li><em>“Operation”</em>: <code class="language-plaintext highlighter-rouge">Keep last lines</code></li>
        <li><em>“Number of lines”</em>: Choose a value, e.g. <code class="language-plaintext highlighter-rouge">100</code></li>
      </ul>
    </li>
    <li>Click <strong>Run Tool</strong></li>
    <li>Wait for the job to finish</li>
    <li>
      <p>Inspect the file through the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon (<strong>View data</strong>)</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <ol>
          <li>How are the chromosomes named?</li>
          <li>How are the chromosomes X and Y named?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <ol>
            <li>The chromosomes are just given by their number. In the gene file from UCSC, they started with <code class="language-plaintext highlighter-rouge">chr</code></li>
            <li>The chromosomes X and Y are named 20 and 21</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<p>In order to convert the chromosome names we have therefore two things to do:</p>

<ol>
  <li>add <code class="language-plaintext highlighter-rouge">chr</code></li>
  <li>change 20 and 21 to X and Y</li>
</ol>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-adjust-chromosome-names"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Adjust chromosome names</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3" title="Replace Text tool" aria-role="link"><strong>Replace Text</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3</span></span> in a specific column with the following settings:
      <ul>
        <li><em>“File to process”</em>: our peak file <code class="language-plaintext highlighter-rouge">GSE37268_mof3.out.hpeak.txt.gz</code></li>
        <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
        <li>
          <p><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">[0-9]+</code></p>

          <p>This will look for numerical digits</p>
        </li>
        <li>
          <p><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">chr&amp;</code></p>

          <p><code class="language-plaintext highlighter-rouge">&amp;</code> is a placeholder for the find result of the pattern search</p>
        </li>
      </ul>
    </li>
    <li>
      <p>Rename your output file <code class="language-plaintext highlighter-rouge">chr prefix added</code>.</p>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3" title="Replace Text tool" aria-role="link"><strong>Replace Text</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3</span></span>  : Let’s rerun the tool with two more replacements
      <ul>
        <li><em>“File to process”</em>: the output from the last run, <code class="language-plaintext highlighter-rouge">chr prefix added</code></li>
        <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> Replacement
          <ul>
            <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">chr20</code></li>
            <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">chrX</code></li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> Insert Replacement
          <ul>
            <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">chr21</code></li>
            <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">chrY</code></li>
          </ul>
        </li>
      </ul>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-rerunning-a-tool"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-rerunning-a-tool" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> Tip: Rerunning a tool<span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ul>
          <li>Expand the dataset information</li>
          <li>Press the <i class="fas fa-redo" aria-hidden="true"></i><span class="visually-hidden">galaxy-refresh</span> icon (<strong>Run this job again</strong>)</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p>Inspect the latest file through the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon. Have we been successful?</p>

      <p>We have quite a few files now and need to take care to select the correct ones at each step.</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>How many regions are in our output file? You can click the name of the output to expand it and see the number.</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <p>It should be equal to the number of regions in your first file, <code class="language-plaintext highlighter-rouge">GSE37268_mof3.out.hpeak.txt.gz</code>: 48,647
If yours says 100 regions, then you have run it on the <code class="language-plaintext highlighter-rouge">Tail</code> file and need to re-run the steps.</p>
        </blockquote>
      </blockquote>
    </li>
    <li>Rename the file to something more recognizable, e.g. <code class="language-plaintext highlighter-rouge">Peak regions</code></li>
  </ol>
</blockquote>

<h2 id="analysis">Analysis</h2>

<p>Our goal is to compare the 2 region files (the genes file and the peak file from the publication)
to know which peaks are related to which genes. If you only want to know which peaks are located <strong>inside</strong> genes (within the gene body) you
can skip the next step. Otherwise, it might be reasonable to include the <strong>promoter</strong> region of the genes into the comparison, e.g. because
you want to include transcriptions factors in ChIP-seq experiments. There is no strict definition for promoter region but 2kb upstream of the TSS (start of region) is commonly used. We’ll use the <strong>Get Flanks</strong> tool to get regions 2kb bases upstream of the start of the gene to 10kb bases downstream of the start (12kb in length). To do this we tell the Get Flanks tool we want regions upstream of the start, with an offset of 10kb, that are 12kb in length, as shown in the diagram below.</p>

<p><a href="../../images/intro_get_flanks.png" rel="noopener noreferrer"><img src="../../images/intro_get_flanks.png" alt="Get Flanks. " width="295" height="206" loading="lazy" /></a></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-add-promoter-region-to-gene-records"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Add promoter region to gene records</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/get_flanks/get_flanks1/1.0.0" title="Get Flanks tool" aria-role="link"><strong>Get Flanks</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/devteam/get_flanks/get_flanks1/1.0.0</span></span> returns flanking region/s for every gene, with the following settings:
      <ul>
        <li><em>“Select data”</em>: <code class="language-plaintext highlighter-rouge">Genes</code> file from UCSC</li>
        <li><em>“Region”</em>: <code class="language-plaintext highlighter-rouge">Around Start</code></li>
        <li><em>“Location of the flanking region/s”</em>: <code class="language-plaintext highlighter-rouge">Upstream</code></li>
        <li><em>“Offset”</em>: <code class="language-plaintext highlighter-rouge">10000</code></li>
        <li><em>“Length of the flanking region(s)”</em>: <code class="language-plaintext highlighter-rouge">12000</code></li>
      </ul>

      <p>This tool returns flanking regions for every gene</p>
    </li>
    <li>
      <p>Compare the rows of the resulting BED file with the input to find out how the start and end positions changed</p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-inspecting-several-files-using-the-scratchbook"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-inspecting-several-files-using-the-scratchbook" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> Tip: Inspecting several files using the scratchbook<span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ul>
          <li>
            <p>Click <strong>Enable/Disable Scratchbook</strong> on the top panel</p>

            <p><a href="../../images/intro_scratchbook_enable.png" rel="noopener noreferrer"><img src="../../images/intro_scratchbook_enable.png" alt="Enable/Disable Scratchbook. " width="189" height="66" loading="lazy" /></a></p>
          </li>
          <li>Click on the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> (eye) icon of the files to inspect</li>
          <li>
            <p>Click on <strong>Show/Hide Scratchbook</strong></p>

            <p><a href="../../images/intro_scratchbook_show_hide.png" rel="noopener noreferrer"><img src="../../images/intro_scratchbook_show_hide.png" alt="Show/Hide Scratchbook. " width="209" height="68" loading="lazy" /></a></p>
          </li>
        </ul>
      </blockquote>
    </li>
    <li>Rename your dataset to reflect your findings (<code class="language-plaintext highlighter-rouge">Promoter regions</code>)</li>
  </ol>
</blockquote>

<p>The output is regions that start from 2kb upstream of the TSS and include 10kb downstream. For input regions on the positive strand e.g. <code class="language-plaintext highlighter-rouge">chr1 134212701 134230065</code> this gives <code class="language-plaintext highlighter-rouge">chr1 134210701 134222701</code>. For regions on the negative strand e.g. <code class="language-plaintext highlighter-rouge">chr1 8349819 9289958</code> this gives <code class="language-plaintext highlighter-rouge">chr1  9279958 9291958</code>.</p>

<p>You might have noticed that the UCSC file is in <code class="language-plaintext highlighter-rouge">BED</code> format and has a database associated to it. That’s what we want for our peak file as well. The <strong>Intersect</strong> tool we will use can automatically convert interval files to BED format but we’ll convert our interval file explicitly here to show how this can be achieved with Galaxy.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-change-format-and-database"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Change format and database</div>

  <ol>
    <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (pencil) icon in the history entry of our peak region file</li>
    <li>Switch to the <strong>Convert</strong> tab</li>
    <li>Under <em>“Target datatype”</em>: <code class="language-plaintext highlighter-rouge">bed (using 'interval-to-bed')</code></li>
    <li>Press <strong>Create Dataset</strong></li>
    <li>Check that the “Database/Build” is <code class="language-plaintext highlighter-rouge">mm9</code> (the database build for mice used in the paper)</li>
    <li>Again rename the file to something more recognizable, e.g. <code class="language-plaintext highlighter-rouge">Peak regions BED</code></li>
  </ol>
</blockquote>

<p>It’s time to find the overlapping intervals (finally!). To do that, we want to extract the genes which overlap/intersect with our peaks.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-find-overlaps"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Find Overlaps</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/intersect/gops_intersect_1/1.0.0" title="Intersect tool" aria-role="link"><strong>Intersect</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/devteam/intersect/gops_intersect_1/1.0.0</span></span> the intervals of two datasets, with the following settings:
      <ul>
        <li><em>“Return”</em>: <code class="language-plaintext highlighter-rouge">Overlapping Intervals</code></li>
        <li><em>“of”</em>: the UCSC file with promoter regions (<code class="language-plaintext highlighter-rouge">Promoter regions</code>)</li>
        <li><em>“that intersect”</em>: our peak region file from <strong>Replace</strong> (<code class="language-plaintext highlighter-rouge">Peak regions BED</code>)</li>
        <li><em>“for at least”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
      </ul>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
        <p>The order of the inputs is important! We want to end up with a list of <strong>genes</strong>, so the corresponding dataset with the gene information needs to be the first input (<code class="language-plaintext highlighter-rouge">Promoter regions</code>).</p>
      </blockquote>
      <p><a href="../../images/intro_overlapping_genes.png" rel="noopener noreferrer"><img src="../../images/intro_overlapping_genes.png" alt="Genes overlapping peaks. " width="1420" height="486" loading="lazy" /></a></p>
    </li>
  </ol>
</blockquote>

<p>We now have the list of genes (column 4) overlapping with the peak regions, similar to shown above.</p>

<p>To get a better overview of the genes we obtained, we want to look at their distribution across the different chromosomes.
We will group the table by chromosome and count the number of genes with peaks on each chromosome</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-count-genes-on-different-chromosomes"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Count genes on different chromosomes</div>

  <ol>
    <li><span class="tool" data-tool="Grouping1" title="Group tool" aria-role="link"><strong>Group</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Grouping1</span></span> data by a column and perform aggregate operation on other columns, with the following settings:
      <ul>
        <li><em>“Select data”</em> to the result of the intersection</li>
        <li><em>“Group by column”</em>:<code class="language-plaintext highlighter-rouge">Column 1</code></li>
        <li>Press <strong>Insert Operation</strong> and choose:
          <ul>
            <li><em>“Type”</em>: <code class="language-plaintext highlighter-rouge">Count</code></li>
            <li><em>“On column”</em>: <code class="language-plaintext highlighter-rouge">Column 1</code></li>
            <li><em>“Round result to nearest integer?”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          </ul>
        </li>
      </ul>

      <blockquote class="question">
        <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>Which chromosome contained the highest number of target genes?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>

          <p>The result varies with different settings, for example, the annotation may change due to updates at UCSC. If you followed step by step, with the same annotation, it should be chromosome 11 with 1992 genes. Note that for reproducibility, you should keep all input data used within the analysis. Rerunning the analysis with the same set of parameters, stored Galaxy, can lead to a different result if the inputs changed e.g. the annotation from UCSC.</p>
        </blockquote>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h2 id="visualization">Visualization</h2>

<p>We have some nice aggregated data, so why not draw a barchart of it?</p>

<p>Before we do that we should polish our grouped data a bit more though.</p>

<p>You may have noticed that the mouse chromosomes are not listed in their correct
order in that dataset (the <strong>Group</strong> tool tried to sort them, but did so
alphabetically).</p>

<p>We can fix this by running a dedicated tool for sorting on our data.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-fix-sort-order-of-gene-counts-table"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Fix sort order of gene counts table</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/1.1.1" title="Sort tool" aria-role="link"><strong>Sort</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/1.1.1</span></span> data in ascending or descending order, with the following settings:
      <ul>
        <li><em>“Sort Query”</em>: result of running the Group tool</li>
        <li>in <i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Column selections”</em>
          <ul>
            <li><em>“on column”</em>: <code class="language-plaintext highlighter-rouge">Column 1</code></li>
            <li><em>“in”</em>: <code class="language-plaintext highlighter-rouge">Ascending order</code></li>
            <li><em>“Flavor”</em>: <code class="language-plaintext highlighter-rouge">Natural/Version sort (-V)</code></li>
          </ul>
        </li>
      </ul>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-multipile-similar-tools-available"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-multipile-similar-tools-available" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Multipile similar tools available<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Sometimes there are multiple tools with very similar names. If the parameters in the tutorial don’t match with what you see in Galaxy, please try the following:</p>   <ol>   <li>     <p>Use <strong>Tutorial Mode</strong> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> in Galaxy, and click on the blue tool button in the tutorial to automatically open the correct tool and version (not available for all tutorials yet)</p>     <!--SNIPPET-->     <blockquote class="tip">   <div class="box-title tip-title" id="tip-using-tutorial-mode"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-tutorial-mode" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Using tutorial mode<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Tools are frequently updated to new versions. Your Galaxy may have multiple versions of the same tool available. By default, you will be shown the latest version of the tool. This may NOT be the same tool used in the tutorial you are accessing. Furthermore, if you use a newer tool in one step, and try using an older tool in the next step… this may fail! To ensure you use the same tool versions of a given tutorial, use the <strong>Tutorial mode</strong> feature.</p>   <ul>   <li>Open your Galaxy server</li>   <li>Click on the <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> icon on the top menu, this will open the GTN inside Galaxy.</li>   <li>Navigate to your tutorial</li>   <li>Tool names in tutorials will be blue buttons that open the correct tool for you</li>   <li><strong>Note:</strong> this does not work for all tutorials (yet)   <img src="/training-material/topics/contributing/images/88277962-ddda4a80-cce1-11ea-92cd-41b1df063db0.gif" alt="gif showing how GTN-in-Galaxy works" /></li>   <li>You can click anywhere in the grey-ed out area outside of the tutorial box to return back to the Galaxy analytical interface</li> </ul>   <blockquote class="warning">   <div class="box-title warning-title" id="warning-not-all-browsers-work"><i class="fas fa-exclamation-triangle" aria-hidden="true" ></i> Warning: Not all browsers work!</div>   <ul>     <li>We’ve had some issues with Tutorial mode on Safari for Mac users.</li>     <li>Try a <strong>different browser</strong> if you aren’t seeing the button.</li>   </ul> </blockquote> </blockquote>     <p><!--END_SNIPPET--></p>   </li>   <li>     <p>Check that the <strong>entire tool name</strong> matches what you see in the tutorial.  Please check that:</p>     <ul>       <li>         <p><strong>Full tool name</strong>: <code class="language-plaintext highlighter-rouge">Sort data in ascending or descending order</code></p>       </li>       <li>         <p><strong>Tool version</strong>: <code class="language-plaintext highlighter-rouge">1.1.1</code> (written after the tool name)</p>       </li>     </ul>   </li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>Great, we are ready to plot things!</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-draw-barchart"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Draw barchart</div>

  <ol>
    <li>Click on <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> (visualize) icon on the output from the <strong>Group</strong> tool</li>
    <li>Select <code class="language-plaintext highlighter-rouge">Bar diagram (NVD3)</code></li>
    <li>Click on the <strong>«</strong> in the upper right corner</li>
    <li>Choose a title at <strong>Provide a title</strong>, e.g. <code class="language-plaintext highlighter-rouge">Gene counts per chromosome</code></li>
    <li>Switch to the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden">galaxy-chart-select-data</span> <strong>Select data</strong> tab and play around with the settings</li>
    <li>
      <p>When you are happy, click the <i class="far fa-save" aria-hidden="true"></i><span class="visually-hidden">galaxy-save</span> <strong>Save</strong> visualization in the top right of the <em>main panel</em></p>

      <p>This will store it to your saved visualisations. Later you can view,
download, or share it with others from <strong>User -&gt; Visualizations</strong> in the
top menu of Galaxy.</p>
    </li>
  </ol>

</blockquote>

<h2 id="extracting-workflow">Extracting workflow</h2>

<p>When you look carefully at your history, you can see that it contains all the steps of our analysis, from the beginning to the end. By building this history we have actually built a complete record of our analysis with Galaxy preserving all parameter settings applied at every step.
Wouldn’t it be nice to just convert this history into a workflow that we’ll be able to execute again and again?</p>

<p>Galaxy makes this very simple with the <code class="language-plaintext highlighter-rouge">Extract workflow</code> option. This means that any time you want to build a workflow, you can just perform it manually once, and then convert it to a workflow, so that next time it will be a lot less work to do the same analysis. It also allows you to easily share or publish your analysis.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-extract-workflow"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Extract workflow</div>

  <ol>
    <li>
      <p><strong>Clean up</strong> your history: remove any failed (red) jobs from your history by clicking on the <i class="fas fa-trash" aria-hidden="true"></i><span class="visually-hidden">galaxy-delete</span> button.</p>

      <p>This will make the creation of the workflow easier.</p>
    </li>
    <li>
      <p>Click on <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> (<strong>History options</strong>) at the top of your history panel and select <strong>Extract workflow</strong>.</p>

      <p><a href="../../images/history_menu_extract_workflow.png" rel="noopener noreferrer"><img src="../../images/history_menu_extract_workflow.png" alt="`Extract Workflow` entry in the history options menu. " width="247" height="327" loading="lazy" /></a></p>

      <p>The central panel will show the content of the history in reverse order (oldest on top), and you will be able to choose which steps to include in the workflow.</p>
    </li>
    <li>
      <p>Replace the <strong>Workflow name</strong> to something more descriptive, for example: <code class="language-plaintext highlighter-rouge">From peaks to genes</code></p>
    </li>
    <li>
      <p>If there are any steps that shouldn’t be included in the workflow, you can <strong>uncheck</strong> them in the first column of boxes.</p>

      <p>Since we did some steps which where specific to our custom peak file, we might want to exclude:</p>
      <ul>
        <li><strong>Select last</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>all <strong>Replace Text</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> steps</li>
        <li><strong>Convert Genomic Intervals to BED</strong></li>
        <li><strong>Get flanks</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      </ul>
    </li>
    <li>
      <p>Click on the <strong>Create Workflow</strong> button near the top.</p>

      <p>You will get a message that the workflow was created. But where did it go?</p>
    </li>
    <li>
      <p>Click on <strong>Workflow</strong> in the top menu of Galaxy</p>

      <p>Here you have a list of all your workflows</p>
    </li>
    <li>
      <p>Select the newly generated workflow and click on <strong>Edit</strong></p>

      <p>You should see something similar to this:</p>

      <p><a href="../../images/intro_06.png" rel="noopener noreferrer"><img src="../../images/intro_06.png" alt="Editing workflow interface. " width="450" height="393" loading="lazy" /></a></p>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-the-workflow-editor"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: The workflow editor</div>
        <p>We can examine the workflow in Galaxy’s workflow editor. Here you can view/change the parameter settings of each step, add and remove tools, and connect an output from one tool to the input of another, all in an easy and graphical manner. You can also use this editor to build workflows from scratch.</p>
      </blockquote>

      <p>Although we have our two inputs in the workflow they are missing their connection to the first tool (<strong>Intersect</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>), because we didn’t carry over some of the intermediate steps.</p>
    </li>
    <li>Connect each input dataset to the <strong>Intersect</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> tool by dragging the arrow pointing outwards on the right of its box (which denotes an output) to an arrow on the left of the <strong>Intersect</strong> box pointing inwards (which denotes an input)</li>
    <li>Rename the input datasets to <code class="language-plaintext highlighter-rouge">Reference regions</code> and <code class="language-plaintext highlighter-rouge">Peak regions</code></li>
    <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> (gear) icon at the top right</li>
    <li>Press <strong>Auto Re-layout</strong> to clean up our view
<a href="../../images/intro_07.png" rel="noopener noreferrer"><img src="../../images/intro_07.png" alt="Auto re-layouting. " width="793" height="275" loading="lazy" /></a></li>
    <li>Click on the <i class="far fa-save" aria-hidden="true"></i><span class="visually-hidden">galaxy-save</span> <strong>Save</strong> icon (top-right) to save your changes
<a href="/training-material/topics/contributing/images/save_workflow.png" rel="noopener noreferrer"><img src="/training-material/topics/contributing/images/save_workflow.png" alt="Save workflow button. " width="635" height="240" loading="lazy" /></a></li>
  </ol>

  <blockquote class="tip">
    <div class="box-title tip-title" id="tip-hiding-intermediate-steps"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-hiding-intermediate-steps" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> Tip: Hiding intermediate steps<span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>When a workflow is executed, the user is usually primarily interested in the final product and not in all intermediate steps. By default all the outputs of a workflow will be shown, but we can explicitly tell Galaxy which output to show and which to hide for a given workflow. This behaviour is controlled by the little asterisk next to every output dataset:</p>

    <p><a href="../../../../shared/images/workflow_editor_mark_output.png" rel="noopener noreferrer"><img src="../../../../shared/images/workflow_editor_mark_output.png" alt="Workflow editor mark output. " width="339" height="200" loading="lazy" /></a></p>

    <p>If you click on this asterisk for any of the output datasets, then <em>only</em> files with an asterisk will be shown, and all outputs without an asterisk will be hidden (Note that clicking <em>all</em> outputs has the same effect as clicking <em>none</em> of the outputs, in both cases all the datasets will be shown).</p>
  </blockquote>

</blockquote>

<p>Now it’s time to reuse our workflow for a more sophisticated approach.</p>

<h1 id="part-2-more-sophisticated-approach">Part 2: More sophisticated approach</h1>

<p>In part 1 we used an overlap definition of 1 bp (default setting) to identify genes associated with the peak regions. However, the peaks could be broad, so instead, in order to get a more meaningful definition, we could identify the genes that overlap where most of the reads are concentrated, the <strong>peak summit</strong>. We will use the information on the position of the peak summit contained in the original peak file and check for overlap of the summits with genes.</p>

<h2 id="preparation">Preparation</h2>

<p>We again need our peak file, but we’d like to work in a clean history. Instead of uploading it twice, we can copy it to a new history.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-copy-history-items"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Copy history items</div>

  <ol>
    <li>
      <p>Create a new history and give it a new name like <code class="language-plaintext highlighter-rouge">Galaxy Introduction Part 2</code></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Creating a new history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>   <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>   <ol>   <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>   <li>Select the option <strong>Create New</strong> from the menu</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Click on the <strong>View all histories</strong> (<i class="fas fa-columns" aria-hidden="true"></i><span class="visually-hidden">galaxy-columns</span> icon) at the top right of your history</p>

      <p>You should see both of your histories side-by-side now</p>
    </li>
    <li>Drag and drop the edited peak file (<code class="language-plaintext highlighter-rouge">Peak regions</code>, after the replace steps), which contains the summit information, to your new history.</li>
    <li>Click on the Home icon <i class="fas fa-home" aria-hidden="true"></i><span class="visually-hidden">galaxy-home</span> (or <strong>Analyze Data</strong> on older Galaxy versions) in the top menu bar to go back to your analysis window</li>
  </ol>

</blockquote>

<h2 id="create-peak-summit-file">Create peak summit file</h2>

<p>We need to generate a new BED file from the original peak file that contains the positions of the peak summits. The start of the summit is the start of the peak (column 2) plus the location within the peak that has the highest hypothetical DNA fragment coverage (column 5, rounded down to the next smallest integer because some peak summits fall in between to bases). As the end of the peak region, we will simply define <code class="language-plaintext highlighter-rouge">start + 1</code>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-create-peak-summit-file"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Create peak summit file</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0" title="Compute on rows tool" aria-role="link"><strong>Compute on rows</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0</span></span> with the following parameters:
      <ul>
        <li><em>“Input file”</em>: our peak file <code class="language-plaintext highlighter-rouge">Peak regions</code> (the interval format file)</li>
        <li>*“Input has a header line with column names?”: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li>In <em>“Expressions”</em>:</li>
      </ul>
      <ul>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Expressions”</em>
          <ul>
            <li><em>“Add expression”</em>: <code class="language-plaintext highlighter-rouge">c2 + int(c5)</code></li>
            <li><em>“Mode of the operation”</em>: Append</li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Expressions”</em>
          <ul>
            <li><em>“Add expression”</em>: <code class="language-plaintext highlighter-rouge">c8 + 1</code></li>
            <li><em>“Mode of the operation”</em>: Append</li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>

  <p>This will create an 8th and a 9th column in our table, which we will use in our next step:</p>

  <ol>
    <li>Rename the output <code class="language-plaintext highlighter-rouge">Peak summit regions</code></li>
  </ol>

</blockquote>

<p>Now we cut out just the chromosome plus the start and end of the summit:</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-cut-out-columns"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Cut out columns</div>
  <ol>
    <li><span class="tool" data-tool="Cut1" title="Cut tool" aria-role="link"><strong>Cut</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span> columns from a table with the following settings:
      <ul>
        <li><em>“Cut columns”</em>: <code class="language-plaintext highlighter-rouge">c1,c8,c9</code></li>
        <li><em>“Delimited by Tab”</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><em>“From”</em>: <code class="language-plaintext highlighter-rouge">Peak summit regions</code></li>
      </ul>

      <p>The output from <strong>Cut</strong> will be in <code class="language-plaintext highlighter-rouge">tabular</code> format.</p>
    </li>
    <li>
      <p>Change the format to <code class="language-plaintext highlighter-rouge">interval</code> (use the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span>) since that’s what the tool <strong>Intersect</strong> expects.</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-changing-the-datatype"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-changing-the-datatype" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Changing the datatype<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> <strong>Convert</strong> tab on the top</li>   <li>In the lower part <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden">galaxy-chart-select-data</span> <strong>Datatypes</strong>, select <code class="language-plaintext highlighter-rouge">interval</code>     <ul>       <li>tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <p>The output should look like below:</p>

      <p><a href="../../images/intro_summits.png" rel="noopener noreferrer"><img src="../../images/intro_summits.png" alt="Peak summits. " width="186" height="273" loading="lazy" /></a></p>
    </li>
  </ol>
</blockquote>

<h2 id="get-gene-names">Get gene names</h2>

<p>The RefSeq genes we downloaded from UCSC did only contain the RefSeq identifiers, but not the gene names. To get a list of gene names in the end, we use another BED file from the Data Libraries.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-1"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
  <p>There are several ways to get the gene names in, if you need to do it yourself. One way is to retrieve a mapping through Biomart and then join the two files (<strong>Join two Datasets side by side on a specified field</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>). Another is to get the full RefSeq table from UCSC and manually convert it to BED format.</p>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload</div>

  <ol>
    <li>
      <p><span class="tool" data-tool="upload1" title="Import tool" aria-role="link"><strong>Import</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: upload1</span></span> <code class="language-plaintext highlighter-rouge">mm9.RefSeq_genes_from_UCSC.bed</code> from <a href="https://zenodo.org/record/1025586">Zenodo</a> or from the data library:</p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/1025586/files/mm9.RefSeq_genes_from_UCSC.bed
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing via links<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Genome</strong> to <code class="language-plaintext highlighter-rouge">mm9</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-data-from-a-data-library"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-from-a-data-library" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing data from a data library<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>     <p>Navigate to : <em>Click on “Training data” and then “Introduction - From peaks to genes”</em> or  the correct folder as indicated by your instructor.</p>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class="fas fa-caret-down" aria-hidden="true"></i><span class="visually-hidden">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>

      <p>As default, Galaxy takes the link as name, so rename them.</p>
    </li>
    <li>
      <p>Inspect the file content to check if it contains gene names.
It should look similar to below:
<a href="../../images/intro_gene_names.png" rel="noopener noreferrer"><img src="../../images/intro_gene_names.png" alt="Gene names. " width="660" height="302" loading="lazy" /></a></p>
    </li>
    <li>Rename it <code class="language-plaintext highlighter-rouge">mm9.RefSeq_genes</code></li>
    <li>Apply the tag <code class="language-plaintext highlighter-rouge">#genes</code></li>
  </ol>

</blockquote>

<h2 id="repeat-workflow">Repeat workflow</h2>

<p>It’s time to reuse the workflow we created earlier.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-run-a-workflow"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Run a workflow</div>
  <ol>
    <li>Open the workflow menu (top menu bar)</li>
    <li>Find the workflow you made in the previous section, and select the option <strong>Run</strong></li>
    <li>Choose as inputs our <code class="language-plaintext highlighter-rouge">mm9.RefSeq_genes</code> (<code class="language-plaintext highlighter-rouge">#genes</code>) BED file and the result of the <strong>Cut</strong> tool (<code class="language-plaintext highlighter-rouge">#peaks</code>)</li>
    <li>
      <p>Click <strong>Run workflow</strong></p>

      <p>The outputs should appear in the history but it might take some time until they are finished.</p>
    </li>
  </ol>

</blockquote>

<p>We used our workflow to rerun our analysis with the peak summits. The <strong>Group</strong> tool again produced a list containing the number of genes found in each chromosome.
But wouldn’t it be more interesting to know the number of peaks in each unique gene? Let’s rerun the workflow with different settings!</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-run-a-workflow-with-changed-settings"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Run a workflow with changed settings</div>
  <ol>
    <li>Open the workflow menu (top menu bar)</li>
    <li>Find the workflow you made in the previous section, and select the option <strong>Run</strong></li>
    <li>Choose as inputs our <code class="language-plaintext highlighter-rouge">mm9.RefSeq_genes</code> (<code class="language-plaintext highlighter-rouge">#genes</code>) BED file and the result of the <strong>Cut</strong> tool (<code class="language-plaintext highlighter-rouge">#peaks</code>)</li>
    <li>Click on the title of the <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> <strong>Group</strong> tool to expand the options.</li>
    <li>Change the following settings by clicking on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (pencil) icon on the left:
      <ul>
        <li><em>“Group by column”</em>: <code class="language-plaintext highlighter-rouge">7</code></li>
        <li>In <em>“Operation”</em>:
          <ul>
            <li><em>“On column”</em>: <code class="language-plaintext highlighter-rouge">7</code></li>
          </ul>
        </li>
      </ul>
    </li>
    <li>Click <strong>Run workflow</strong></li>
  </ol>
</blockquote>

<p>Congratulations! You should have a file with all the unique gene names and a count on how many peaks they contained.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>The list of unique genes is not sorted. Try to sort it on your own!</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>You can use the tool “Sort data in ascending or descending order” on column 2 and “fast numeric sort”.</p>
  </blockquote>
</blockquote>

<h1 id="share-your-work">Share your work</h1>

<p>One of the most important features of Galaxy comes at the end of an analysis. When you have published striking findings, it is important that other researchers are able to reproduce your in-silico experiment. Galaxy enables users to easily share their workflows and histories with others.</p>

<p>To share a history, click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> (gear) symbol in the history pane and select <code class="language-plaintext highlighter-rouge">Share or Publish</code>. On this page you can do 3 things:</p>

<ol>
  <li>
    <p><strong>Make accessible via Link</strong></p>

    <p>This generates a link that you can give out to others. Anybody with this link will be able to view your history.</p>
  </li>
  <li>
    <p><strong>Publish History</strong></p>

    <p>This will not only create a link, but will also publish your history. This means your history will be listed under <code class="language-plaintext highlighter-rouge">Shared Data → Published Histories</code> in the top menu.</p>
  </li>
  <li>
    <p><strong>Share with Individual Users</strong></p>

    <p>This will share the history only with specific users on the Galaxy instance.</p>
  </li>
</ol>

<p><a href="../../images/publish.PNG" rel="noopener noreferrer"><img src="../../images/publish.PNG" alt="The menu for sharing histories includes buttons for making the history accessible, publishing it on this Galaxy server, and displays a sharable link to the history. At the bottom is a button for sharing the history with individual users." width="597" height="430" loading="lazy" /></a></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-share-history-and-workflow"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Share history and workflow</div>

  <ol>
    <li>Share one of your histories with your neighbour</li>
    <li>See if you can do the same with your workflow!</li>
    <li>
      <p>Find the history and/or workflow shared by your neighbour</p>

      <p>Histories shared with specific users can be accessed by those users in their history menu (<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> (gear) icon) under <code class="language-plaintext highlighter-rouge">Histories shared with me</code>.</p>
    </li>
  </ol>

</blockquote>

<h1 id="conclusion">Conclusion</h1>

<p><i class="fas fa-trophy" aria-hidden="true"></i><span class="visually-hidden">trophy</span> You have just performed your first analysis in Galaxy. You also created a workflow from your analysis so you can easily repeat the exact same analysis on other datasets. Additionally you shared your results and methods with others.</p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>Galaxy provides an easy-to-use graphical user interface for often complex commandline tools</p>
</li>
                        
                        <li><p>Galaxy keeps a full record of your analysis in a history</p>
</li>
                        
                        <li><p>Workflows enable you to repeat your analysis on different data</p>
</li>
                        
                        <li><p>Galaxy can connect to external sources for data import and visualization purposes</p>
</li>
                        
                        <li><p>Galaxy provides ways to share your results and methods with others</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/introduction/faqs/">FAQ page for the Introduction to Galaxy Analyses topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="Li2012">Li, X., L. Li, R. Pandey, J. S. Byun, K. Gardner <i>et al.</i>, 2012 <b>The Histone Acetyltransferase MOF Is a Key Regulator of the Embryonic Stem Cell Core Transcriptional Network</b>. Cell Stem Cell 11: 163–178. <a href="https://doi.org/10.1016/j.stem.2012.04.023">10.1016/j.stem.2012.04.023</a></li></ol>
                

                

                <h1>Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=From peaks to genes (Introduction to Galaxy Analyses)" alt="Feedback form link">
                    <img src="/training-material/shared/images/feedback.png" alt="Preview of the google form" />
                </a>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Anne Pajon, Clemens Blank, Bérénice Batut, Björn Grüning, Nicola Soranzo, Dilmurat Yusuf, Sarah Peter, Helena Rasche,  <b>From peaks to genes (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html">https://training.galaxyproject.org/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{introduction-galaxy-intro-peaks2genes,
author = "Anne Pajon and Clemens Blank and Bérénice Batut and Björn Grüning and Nicola Soranzo and Dilmurat Yusuf and Sarah Peter and Helena Rasche",
	title = "From peaks to genes (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

                


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="agenda follow-up" id="admins-install-missing-tools">
                    <div class="box-title">Galaxy Administrators: Install the missing tools</div>
			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: text_processing
  owner: bgruening
  revisions: d698c222f354
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: text_processing
  owner: bgruening
  revisions: d698c222f354
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: text_processing
  owner: bgruening
  revisions: d698c222f354
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: column_maker
  owner: devteam
  revisions: 6595517c2dd8
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: get_flanks
  owner: devteam
  revisions: 077f404ae1bb
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: intersect
  owner: devteam
  revisions: 69c10b56f46d
  tool_panel_section_label: Introduction to Galaxy Analyses
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		


                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-6" style="text-align: left">
				<p>
					The <a href="https://galaxyproject.org/teach/gtn/">Galaxy Training Network</a>
					provides researchers with online training materials, connects them with local trainers, and helps promoting FAIR and Open Science practices worldwide. All contributions are subject to the <a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Galaxy Project Code of Conduct</a>.
				</p>
				<p>
				The GTN infrastructure is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
				</p>
				<p>
				Revision <a href="https://github.com/galaxyproject/training-material/commit/ee51c939937f9893c63a0f9494eaef0bfbfa1c6d">ee51c93</a>, built with Jekyll (4.3.2 | production)
				</p>
			</div>
			<div class="col-sm-6" style="text-align: right">
				
				<p>
					Resource <i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00189">https://gxy.io/GTN:T00189</a>
				</p>
				
				<p>
					<i>This Material</i>:
					
					is licensed under
					<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
						Creative Commons Attribution 4.0 International License
					</a>
				</p>
				<p>
					<a href="https://github.com/galaxyproject/training-material/edit/main/topics/introduction/tutorials/galaxy-intro-peaks2genes/tutorial.md" title="Edit on GitHub">
					<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
					</a>
				</p>
			</div>
		</div>
	</div>
</footer>


    </div>
</footer>


        <script src='/training-material/assets/js/bundle.main.js?v=1703464120'></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>