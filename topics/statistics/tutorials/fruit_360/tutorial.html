<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Image classification in Galaxy with fruit 360 dataset</title>
        
            <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml" />

        
        
        
        
        
        <meta name="description" content="Statistical Analyses for omics data and machine learning ..." />
        <meta property="og:title" content="Galaxy Training: Image classification in Galaxy with fruit 360 dataset" />
        <meta property="og:description" content="Statistical Analyses for omics data and machine learning ..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/statistics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Statistics and machine learning
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Languages">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Languages
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            
                              <strong class="dropdown-header">Automatic Translations</strong>
            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url">
                            Français
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url">
                            日本語
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url">
                            Español
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url">
                            Português
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url">
                            العربية
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/statistics/tutorials/fruit_360/tutorial.html&edit-text=&act=url" title="">
                            And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="/training-material/topics/statistics/faqs/" title="Check our FAQs for the Statistics and machine learning topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        
        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/statistics/tutorials/fruit_360/tutorial.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/statistics/tutorials/fruit_360/tutorial.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        
            <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="progress" class="btn btn-secondary">
                    <input type="radio" name="options" id="progress" autocomplete="off">🏳️‍🌈
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> 🎃
                </label>
                <label data-value="straya" class="btn btn-secondary">
                    <input type="radio" name="options" id="downunder" autocomplete="off"> 🇦🇺
                </label>
            </div>

        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            
            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/" title="Older Versions">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        <div class="container main-content" role="main">
        











<!-- Gitter -->




<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<script type="application/ld+json">
    


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "1970-01-01 00:00:04 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Image classification in Galaxy with fruit 360 dataset",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Statistics and machine learning",
    "description": "Statistical Analyses for omics data and machine learning using Galaxy tools",
    "url": "https://training.galaxyproject.org//training-material/topics/statistics/"
  },
  "courseCode": "statistics / fruit_360 / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Image classification in Galaxy with fruit 360 dataset' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/fruit_360/tutorial.html",
  "timeRequired": "PT2H",
  "description": "The questions this  addresses are:\n - How to solve an image classification problem using convolutional neural network (CNN)?\n\n\\nThe objectives are:\n - Learn how to create a CNN using Galaxy's deep learning tools\n - Solve an image classification problem on fruit 360 dataset using CNN in Galaxy\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/CNN/slides.html",
      "name": "Convolutional neural networks (CNN) \n Deep Learning - Part 3",
      "description": "Slides for 'Convolutional neural networks (CNN) \n Deep Learning - Part 3' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/CNN/tutorial.html",
      "name": "Deep Learning (Part 3) - Convolutional neural networks (CNN)",
      "description": "Hands-on for 'Deep Learning (Part 3) - Convolutional neural networks (CNN)' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Kaivan Kamali"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Kaivan Kamali"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Statistics and machine learning",
      "description": "Statistical Analyses for omics data and machine learning using Galaxy tools",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_2269",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_2269",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_2269"
    }
  ]
}
</script>

<section class="tutorial topic-statistics">
    <h1 data-toc-skip>Image classification in Galaxy with fruit 360 dataset</h1>
    


    <div class="contributors-line">Authors: 
<a href="/training-material/hall-of-fame/kxk302/" class="contributor-badge contributor-kxk302"><img src="https://avatars.githubusercontent.com/kxk302?s=27" alt="Avatar">Kaivan Kamali</a>


<a href="https://training.galaxyproject.org/training-material/topics/contributing/" class="contributor-badge contributor-newcontributors"><i class="fas fa-users" aria-hidden="true"></i><span class="visually-hidden">hall-of-fame</span>Add Contributions!</a>

</div>


    <blockquote class="overview">
        <h3>Overview</h3>
        
        <img alt="Creative Commons License" class="float-right" style="border-width:0; display: inline-block; margin:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" aria-hidden="true" />
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>How to solve an image classification problem using convolutional neural network (CNN)?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Learn how to create a CNN using Galaxy’s deep learning tools</p>
</li>
        
        <li><p>Solve an image classification problem on fruit 360 dataset using CNN in Galaxy</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

        
    <li>
    
        
        
        <a href="/training-material/topics/statistics">Statistics and machine learning</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Deep Learning (Part 3) - Convolutional neural networks (CNN):
                            
                                <a href="/training-material/topics/statistics/tutorials/CNN/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/statistics/tutorials/CNN/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 2 hours</div>
        

        

        
        

        
        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            
                <li class="btn btn-default"><a href="/training-material/topics/statistics/tutorials/fruit_360/slides.html" title="Slides for this tutorial">
                    <i class="fab fa-slideshare" aria-hidden="true"></i> Slides
                </a></li>
            

            
                <li class="btn btn-default supporting_material">


<a class="topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/5702887">
    <i class="far fa-copy" aria-hidden="true"></i> Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="topic-icon" href="/training-material/topics/statistics/tutorials/fruit_360/workflows/" title="Workflows" alt="Image classification in Galaxy with fruit 360 dataset workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i> Workflows
    </a>

</li>
            

            

            

            
            
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            











  
  <li class="btn btn-default supporting_material">
    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Latest recordings of this tutorial in the GTN Video Library">
        <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Recordings
    </a>
    <ul class="dropdown-menu">
        
        
        
        

        <li>

            <a class="dropdown-item" href="https://gallantries.github.io/video-library/videos/statistics/fruit_360" title="View GTN Video Library for this Tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Lecture & Tutorial (January 2022)
            </a>
        </li>
        
        
        
        
    </ul>
   </li>
   



            
                <li class="btn btn-default supporting_material">


    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/statistics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://africa.usegalaxy.eu/" title="Galaxy Africa">
            Galaxy Africa
        </a>
        
    
        
        <a class="dropdown-item" href="https://india.usegalaxy.eu/" title="Galaxy India">
            Galaxy India
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://test.galaxyproject.org/" title="Galaxy Test">
            Galaxy Test
        </a>
        
    
        
        <a class="dropdown-item" href="https://ecology.usegalaxy.eu/" title="Galaxy for Ecology">
            Galaxy for Ecology
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://galaxy.genouest.org" title="Galaxy@GenOuest">
            Galaxy@GenOuest
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://ml.usegalaxy.eu/" title="Machine Learning Workbench">
            Machine Learning Workbench
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://streetscience.usegalaxy.eu/" title="Street Science">
            Street Science
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.eu" title="UseGalaxy.eu">
            UseGalaxy.eu
        </a>
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org" title="UseGalaxy.org (Main)">
            UseGalaxy.org (Main)
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org.au" title="UseGalaxy.org.au">
            UseGalaxy.org.au
        </a>
        
    
        
    
        
    
        
    
        
    
    </ul>


</li>
            
        </ul>
        

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Jan 4, 2022 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Tutorial Content is licensed under Creative Commons Attribution 4.0 International License</a>
            
            <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">The GTN Framework is licensed under MIT</a>
        </div>
    </blockquote>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <h1 class="no_toc" id="introduction">Introduction</h1>

<p>The classification of fruits and vegetables offers many useful applications such as 
automated harvesting by robots, building up stocks for supermarkets, effective detection 
of specific defects, and determining fruit ripeness (<span class="citation"><a href="#Duong2020">Duong <i>et al.</i> 2020</a></span>, 
<span class="citation"><a href="#NaranjoTorres2020">Naranjo-Torres <i>et al.</i> 2020</a></span>, <span class="citation"><a href="#Iswari2017">Iswari <i>et al.</i> 2017</a></span>). Machine Learning (ML) techniques 
such as Deep Learning (DL) are commonly used for image classification problems in various 
domains, including in agriculture (<span class="citation"><a href="#Kamilaris2018">Kamilaris and Prenafeta-Boldú 2018</a></span>). DL is a technique inspired 
by how a human brain operates. Due to the increased availability of compute capacity and 
training data, DL techniques have become very popular in recent years. In this tutorial,
we will use <span class="notranslate">Galaxy</span>’s ML toolkit to build a DL model to classify fruit and vegetable 
images. Our DL model is trained and evaluated on Fruit 360 dataset (<span class="citation"><a href="#Murean2018">Mureşan and Oltean 2018</a></span>)</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#overview-of-convolutional-neural-networks-cnn" id="markdown-toc-overview-of-convolutional-neural-networks-cnn">Overview of convolutional neural networks (CNN)</a></li>
  <li><a href="#architecture-of-cnn" id="markdown-toc-architecture-of-cnn">Architecture of CNN</a></li>
  <li><a href="#fruit-360-dataset" id="markdown-toc-fruit-360-dataset">Fruit 360 dataset</a></li>
  <li><a href="#get-data" id="markdown-toc-get-data">Get data</a></li>
  <li><a href="#classification-of-fruit-360-dataset-images-with-cnn" id="markdown-toc-classification-of-fruit-360-dataset-images-with-cnn">Classification of fruit 360 dataset images with CNN</a></li>
</ol>

</blockquote>
<h2 id="overview-of-convolutional-neural-networks-cnn">Overview of convolutional neural networks (CNN)</h2>

<p>Here we provide a brief overview of CNN. For a more in depth discussion, please refer to the CNN tutorial cited in the requirements 
section. CNN were inspired by how the visual cortex of the brain processes visual information (<span class="citation"><a href="#HubelWiesel">Hubel and Wiesel 1959</a></span>). There are 
two types of cells in our visual cortex: <strong>simple cells</strong> detect objects at certain angles/locations, and <strong>complex</strong> cells,
which receive inputs from multiple simple cells, and detect movement. In 1980, inspired by hierarchical structure of complex and 
simple cells, Fukushima proposed <em>Neocognitron</em> (<span class="citation"><a href="#Fukishima">Fukushima 1988</a></span>), a hierarchical neural network used for handwritten Japanese 
character recognition. In 1989, LeCun et. al. (<span class="citation"><a href="#LeCunEtAl">LeCun <i>et al.</i> 1989</a></span>) proposed a CNN that could be trained by backpropagation 
algorithm. CNN gained immense popularity when they outperformed other models at ImageNet Challenge, a competition in object 
classification and detection on hundreds of object categories and millions of images.</p>

<h2 id="architecture-of-cnn">Architecture of CNN</h2>

<p>A typical CNN has the following 4 layers (<span class="citation"><a href="#OSheaEtAl">O’Shea and Nash 2015</a></span>)</p>

<ol>
  <li>Input layer</li>
  <li>Convolution layer</li>
  <li>Pooling layer</li>
  <li>Fully connected layer</li>
</ol>

<p>Please note that we will explain a 2 dimensional (2D) CNN here. But the same concepts apply to a 1 (or 3) dimensional CNN as well.</p>

<h3 id="input-layer">Input layer</h3>

<p>The input layer represents the input to the CNN. An example input, could be a 28 by 28 pixel grayscale image. We do not
“flatten” the input to a 1D vector. This makes capturing spatial relationships easier.</p>

<h3 id="convolution-layer">Convolution layer</h3>

<p>The convolution layer is composed of multiple <strong>filters</strong> (also called <strong>kernels</strong>). Filters for a 2D image are also 2D. Suppose 
we have a 28 by 28 pixel grayscale image. Each pixel is represented by a number between 0 and 255, where 0 represents the color 
black, 255 represents the color white, and the values in between represent different shades of gray. Suppose we have a 3 by 3 
filter (9 values in total), and the values are randomly set to 0 or 1. Convolution is the process of placing the 3 by 3 filter 
on the top left corner of the image, multiplying filter values by the pixel values and adding the results, moving the filter to 
the right one pixel at a time and repeating this process (Figure 1). When we get to the top right corner of the image, we simply 
move the filter down one pixel and restart from the left. This process ends when we get to the bottom right corner of the image.</p>

<figure id="figure-1"><img src="../../images/Conv_no_padding_no_strides.gif" alt="A 3 by 3 filter applied to a 4 by 4 image, resulting in a 2 by 2 image. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 1:</span> A 3 by 3 filter applied to a 4 by 4 image, resulting in a 2 by 2 image (<span class="citation"><a href="#DumoulinVisin">Dumoulin and Visin 2016</a></span>)</figcaption></figure>

<p>Covolution operator has several parameters.</p>

<ol>
  <li>Filter size</li>
  <li>Padding</li>
  <li>Stride</li>
  <li>Dilation</li>
  <li>Activation function</li>
</ol>

<p>Filter size can be 5 by 5, 3 by 3, and so on. Larger filter sizes should be avoided as more weights need to be learned (more 
compute capacity, more training time, more chance of overfitting). Also, odd sized filters are preferred to even sized filters, 
due to the nice geometric property of all the input pixels being around the output pixel.</p>

<p>If you look at Figure 1 you see that after applying a 3 by 3 filter to a 4 by 4 image, we end up with a 2 by 2 image – the 
size of the image has gone down. If we want to keep the image size the same, we can use <em>padding</em> (Figure 2). We pad the input 
in every direction with 0’s before applying the filter. If the padding is 1 by 1, then we add 1 zero in evey direction. If its 
2 by 2, then we add 2 zeros in every direction, and so on.</p>

<figure id="figure-2"><img src="../../images/Conv_same_padding_no_strides.gif" alt="A 3 by 3 filter applied to a 5 by 5 image, with padding of 1, resulting in a 5 by 5 image. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 2:</span> A 3 by 3 filter applied to a 5 by 5 image, with padding of 1, resulting in a 5 by 5 image (<span class="citation"><a href="#DumoulinVisin">Dumoulin and Visin 2016</a></span>)</figcaption></figure>

<p>As mentioned before, we start the convolution by placing the filter on the top left corner of the image, and after multiplying 
filter and image values (and adding them), we move the filter to the right and repeat the process. How many pixels we move to 
the right (or down) is the <em>stride</em>. In figure 1 and 2, the stride of the filter is 1. We move the filter one pixel to the right 
(or down). But we could use a different stride. Figure 3 shows an example of using stride of 2.</p>

<figure id="figure-3"><img src="../../images/Conv_no_padding_strides.gif" alt="A 3 by 3 filter applied to a 5 by 5 image, with stride of 2, resulting in a 2 by 2 image. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 3:</span> A 3 by 3 filter applied to a 5 by 5 image, with stride of 2, resulting in a 2 by 2 image (<span class="citation"><a href="#DumoulinVisin">Dumoulin and Visin 2016</a></span>)</figcaption></figure>

<p>When we apply a, say 3 by 3, filter to an image, our filter’s output is affected by pixels in a 3 by 3 subset of the image. If we 
like to have a larger <em>receptive field</em> (portion of image that affect filter’s output), we could use <em>dilation</em>. If we set the 
dilation to 2 (Figure 4), instead of a contiguous 3 by 3 subset of the image, every other pixel of a 5 by 5 subset of the image 
affects the filter’s output.</p>

<figure id="figure-4"><img src="../../images/Conv_dilation.gif" alt="A 3 by 3 filter applied to a 7 by 7 image, with dilation of 2, resulting in a 3 by 3 image. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 4:</span> A 3 by 3 filter applied to a 7 by 7 image, with dilation of 2, resulting in a 3 by 3 image (<span class="citation"><a href="#DumoulinVisin">Dumoulin and Visin 2016</a></span>)</figcaption></figure>

<p>After the filter scans the whole image, we apply an activation function to filter output to introduce non-linearlity. The preferred 
activation function used in CNN is ReLU (<span class="citation"><a href="#NwankpaEtAl">Nwankpa <i>et al.</i> 2018</a></span>). ReLU leaves pixels with positive values in filter output as is, 
and replaces negative values with 0. Figure 5 shows the results of applying ReLU activation function to a filter output.</p>

<figure id="figure-5"><img src="../../images/Conv_ReLU.png" alt="Two matrices representing filter output before and after ReLU activation function is applied. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 5:</span> Applying ReLU activation function to filter output</figcaption></figure>

<figure id="figure-6"><img src="../../images/Conv_single_input_channel.png" alt="One matrix representing an input and another matrix representing a filter, along with calculation for single input channel two dimensional convolution operation. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 6:</span> Illustration of single input channel two dimensional convolution</figcaption></figure>

<p>Figure 6 illustrates the calculations for a convolution operation, via a 3 by 3 filter on a single channel 5 by 5 input 
(5 x 5 x 1). Figure 7 illustrates the calculations when the input has 3 channels. To show this in 2 dimensions, we are 
displaying each channel in input and filter separately. Figure 9 shows a sample multi-channel 2D convolution in 3 dimensions.</p>

<figure id="figure-7"><img src="../../images/Conv_multiple_input_channel.png" alt="Three matrices representing an input and another three matrices representing a filter, along with calculation for multiple input channel two dimensional convolution operation . " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 7:</span> Illustration of multiple input channel two dimensional convolution</figcaption></figure>

<p>As Figures 7 and 8 show the output of a multi-channel 2D filter is a single channel 2D image. Applying <em>multiple</em> filters to the 
input image results in a multi-channel 2D image for the output. For example, if the input image is 28 by 28 by 3 
(rows x columns x channels), and we apply a 3 by 3 filter with 1 by 1 padding, we would get a 28 by 28 by 1 image. If we apply 15 
filters to the input image, our output would be 28 by 28 by 15. Hence, the number of filters in a convolution layer allows us to 
increase or decrease the channel size.</p>

<figure id="figure-8"><img src="../../images/Conv_multiple_channel_3d.gif" alt="Multiple cubes representing input, filter, and output in a 3 channel 2 dimensional convolution operation. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 8:</span> Three dimensional illustration of multiple input channel two dimensional convolution (Source: https://thomelane.github.io/convolutions/2DConvRGB.html)</figcaption></figure>

<h3 id="pooling-layer">Pooling layer</h3>

<p>The pooling layer performs down sampling to reduce the spatial dimensionality of the input. This decreases the number of parameters, 
which in turn reduces the learning time and computation, and the likelihood of overfitting. The most popular type of pooling is 
<em>max pooling</em>. Its usually a 2 by 2 filter with a stride of 2 that returns the maximum value as it slides over the input data, 
similar to convolution filters.</p>

<h3 id="fully-connected-layer">Fully connected layer</h3>

<p>The last layer in a CNN is a fully connected layer. We connect all the nodes from the previous layer to this fully connected layer, 
which is responsible for classification of the image.</p>

<figure id="figure-9"><img src="../../images/Conv_CNN.png" alt="A convolutional neural network with 3 convolution layers followed by 3 pooling layers. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 9:</span> A convolutional neural network with 3 convolution layers followed by 3 pooling layers (<span class="citation"><a href="#OSheaEtAl">O’Shea and Nash 2015</a></span>)</figcaption></figure>

<p>As shown in Figure 9, a typical CNN usually has more than one convolution plus pooling layer. Each convolution plus pooling layer 
is responsible for feature extraction at a different level of abstraction. For example, the filters in the first layer could detect 
horizontal, vertical, and diagonal edges. The filters in the next layer could detect shapes, and the filters in the last layer could 
detect collection of shapes. Filter values are randomly initialized and are learned by the learning algorithm. This makes CNN very 
powerful as they not only do classification, but can also automatically do feature extraction. This distinguishes CNN from other classification techniques (like Support Vector Machines), which cannot do feature extraction.</p>

<h2 id="fruit-360-dataset">Fruit 360 dataset</h2>

<p>Fruit 360 is a dataset with 90380 images of 131 fruits and vegetables 
(https://www.kaggle.com/moltean/fruits). Images are 100 pixel by 100 pixel and are color 
(RGB) images (Hence, 3 values for each pixel). There are 67,692 images in the training 
dataset and 22,688 images in the test dataset. The dataset we use for this tutorial is a 
subset of fruit 360 dataset, containing only 10 fruits/vegetables (Strawberry, 
Apple_Red_Delicious, Pepper_Green, Corn, Banana, Tomato_1, Potato_White, Pineapple, 
Orange, and Peach). We selected a subset of fruits/vegetables, so the dataset size is 
smaller and the neural network can be trained faster. Our training dataset has 5,015 images 
and our testing dataset has 1,679 images.</p>

<p>The utilities used to create the subset dataset, along with step by step instructions, can 
be found here: https://github.com/kxk302/fruit_dataset_utilities. First, we created feature 
vectors for each image. Images are 100 pixel by 100 pixel and are color (RGB) images 
(3 values for each pixel). Hence, each image can be represented by 30,000 values 
(100 X 100 X 3). Second, we selected a subset of 10 fruit/vegetable images. Training and 
testing dataset sizes go from 7 GB and 2.5 GB for 131 fruits/vegetables to 500 MB and 
177 MB for 10 fruits/vegetables, respectively. Third, we created separate files for feature 
vectors and labels. Finally, we mapped the labels for the 10 selected fruits/vegetables to 
a range of 0 to 9. Full dataset labels are in the 0 to 130 range, as the full dataset 
includes 131 fruits/vegetables. The 10 labels for out dataset are as follows: Strawberry:0, 
Apple_Red_Delicious:1, Pepper_Green:2, Corn:3, Banana:4, Tomato_1:5, Potato_White:6, Pineapple:7, 
Orange:8, Peach:9.</p>

<h2 id="get-data">Get data</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Data upload</h3>

  <ol>
    <li>
      <p>Make sure you have an empty analysis history.</p>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-tip-creating-a-new-history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Creating a new history</h3>  <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>  <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>  <ol>  <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>  <li>Select the option <strong>Create New</strong> from the menu</li></ol></blockquote>
    </li>
    <li>
      <p><strong>Rename your history</strong> to make it easy to recognize</p>

      <blockquote class="tip">
        <h3 id="tip-rename-a-history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Rename a history</h3>

        <ul>
          <li>
            <p>Click on the title of the history (by default the title is <code class="language-plaintext highlighter-rouge">Unnamed history</code>)</p>

            <p><img src="../../../../shared/images/rename_history.png" alt="Renaming history. " loading="lazy" /></p>
          </li>
          <li>Type <code class="language-plaintext highlighter-rouge"><span class="notranslate">Galaxy</span> Introduction</code> as the name</li>
          <li>Press <kbd>Enter</kbd></li>
        </ul>

      </blockquote>
    </li>
    <li>
      <p>Import the files from <a href="https://zenodo.org/record/5702887">Zenodo</a></p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/5702887/files/train_X_10.tsv
https://zenodo.org/record/5702887/files/train_y_10.tsv
https://zenodo.org/record/5702887/files/test_X_10.tsv
https://zenodo.org/record/5702887/files/test_y_10.tsv
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-tip-importing-via-links"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Importing via links</h3>  <ul>  <li>Copy the link location</li>  <li>    <p>Open the <span class="notranslate">Galaxy</span> Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> on the top-right of the tool panel)</p>  </li>  <li>Select <strong>Paste/Fetch Data</strong></li>  <li>    <p>Paste the link into the text field</p>  </li>  <li>    <p>Press <strong>Start</strong></p>  </li>  <li><strong>Close</strong> the window</li></ul></blockquote>
    </li>
    <li>
      <p>Rename the datasets as <code class="language-plaintext highlighter-rouge">train_X_10</code>, <code class="language-plaintext highlighter-rouge">train_y_10</code>, <code class="language-plaintext highlighter-rouge">test_X_10</code>, and <code class="language-plaintext highlighter-rouge">test_y_10</code> respectively.</p>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-tip-renaming-a-dataset"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Renaming a dataset</h3>  <ul>  <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>  <li>In the central panel, change the <strong>Name</strong> field</li>  <li>Click the <strong>Save</strong> button</li></ul></blockquote>
    </li>
    <li>
      <p>Check that the datatype of all the three datasets is <code class="language-plaintext highlighter-rouge">tabular</code>.</p>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-tip-changing-the-datatype"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Tip: Changing the datatype</h3>  <ul>  <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>  <li>In the central panel, click on the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>  <li>Select <code class="language-plaintext highlighter-rouge">datatypes</code></li>  <li>Click the <strong>Save</strong> button</li></ul></blockquote>
    </li>
  </ol>

</blockquote>

<h2 id="classification-of-fruit-360-dataset-images-with-cnn">Classification of fruit 360 dataset images with CNN</h2>

<p>In this section, we define a CNN and train it using fruit 360 dataset training data. The 
goal is to learn a model such that given an image of a fruit/vegetable, we can predict 
what fruit/vegetable it is (Labels are in the range of 0 to 9). We then evaluate the trained 
CNN on the test dataset and plot the confusion matrix.</p>

<p>In order to train the CNN, we must have the One-Hot Encoding (OHE) representation of the training
labels. This is needed to calculate the categorical cross entropy loss function. OHE encodes labels
as a <strong>one-hot</strong> numeric array, where only one element is 1 and the rest are 0’s. For example, if
we had 3 fruits (apple, orange, banana) and their labels were 1, 2, and 3, the OHE
represntation of apple would be (1,0,0), the OHE representation of orange would be (0,1,0), and the
OHE representation of banana would be (0,0,1). For apple with label 1, the first element of array
is 1 (and the rest are 0’s); For Orange with label 2, the second element of the array is 1 (and the
rest are 0’s); And for Banana with label 3, the third element of the array is 1 (and the rest are 0’s).
We have 10 fruits/vegetables in our dataset and we would just have an array of size 10, where only one
element is 1, corresponding to fruit/vegetable label, and the rest are 0’s.</p>

<p>In order to calculate the OHE of labels, we must first extract the labels column from train_y_10 file.
train_y_10 file has 3 columns: Label_name (string representation of label), file_name (name of fruit/vegetable
image file), and Label (integer representation of label). We extract Label from train_y_10, and then calcuate
its OHE representation.</p>

<h3 id="extract-the-label-column-from-train_y_10"><strong>Extract the Label column from train_y_10</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-advanced-cut"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Advanced Cut</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0"><strong>Advanced Cut</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0</span></span>
      <ul>
        <li><em>“File to cut”</em> : Select <code class="language-plaintext highlighter-rouge">train_y_10</code></li>
        <li><em>“Operation”</em> : Select <code class="language-plaintext highlighter-rouge">Keep</code></li>
        <li><em>“Delimited by”</em>: Select <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><em>“Cut by”</em>: Select <code class="language-plaintext highlighter-rouge">fields</code></li>
        <li><em>“List of fields”</em>: Select <code class="language-plaintext highlighter-rouge">Column: 3</code></li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>

</blockquote>

<h3 id="create-one-hot-encoding-ohe-representation-of-training-labels"><strong>Create One-Hot Encoding (OHE) representation of training labels</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-one-hot-encoding"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: One-Hot Encoding</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/sklearn_to_categorical/sklearn_to_categorical/1.0.8.3" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/sklearn_to_categorical/sklearn_to_categorical/1.0.8.3"><strong>To categorical</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/sklearn_to_categorical/sklearn_to_categorical/1.0.8.3</span></span>
      <ul>
        <li><em>“Input file”</em> : Select the output of the previous step.</li>
        <li><em>“Does the dataset contain header?”</em> : Select <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>“Total number of classes”</em>: Select <code class="language-plaintext highlighter-rouge">10</code></li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>

</blockquote>

<h3 id="create-a-deep-learning-model-architecture"><strong>Create a deep learning model architecture</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-model-config"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Model config</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/keras_model_config/keras_model_config/0.5.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/keras_model_config/keras_model_config/0.5.0"><strong>Create a deep learning model architecture</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/keras_model_config/keras_model_config/0.5.0</span></span>
      <ul>
        <li><em>“Select keras model type”</em>: <code class="language-plaintext highlighter-rouge">sequential</code></li>
        <li><em>“input_shape”</em>: <code class="language-plaintext highlighter-rouge">(30000,)</code></li>
        <li>In <em>“LAYER”</em>:
          <ul>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“1: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Core -- Reshape</code>
                  <ul>
                    <li><em>“target_shape”</em>: <code class="language-plaintext highlighter-rouge">(100,100,3)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“2: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Convolutional -- Conv2D</code>
                  <ul>
                    <li><em>“filters”</em>: <code class="language-plaintext highlighter-rouge">16</code></li>
                    <li><em>“kernel_size”</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
                    <li><em>“Activation function”</em>: <code class="language-plaintext highlighter-rouge">relu</code></li>
                    <li><em>“Type in key words arguments if different from the default”</em>: <code class="language-plaintext highlighter-rouge">input_shape=(100, 100, 3)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“3: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Pooling -- MaxPooling2D</code>
                  <ul>
                    <li><em>“pool_size”</em>: <code class="language-plaintext highlighter-rouge">(2,2)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“4: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Convolutional -- Conv2D</code>
                  <ul>
                    <li><em>“filters”</em>: <code class="language-plaintext highlighter-rouge">32</code></li>
                    <li><em>“kernel_size”</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
                    <li><em>“Activation function”</em>: <code class="language-plaintext highlighter-rouge">relu</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“5: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Pooling -- MaxPooling2D</code>
                  <ul>
                    <li><em>“pool_size”</em>: <code class="language-plaintext highlighter-rouge">(2,2)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“6: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Convolutional -- Conv2D</code>
                  <ul>
                    <li><em>“filters”</em>: <code class="language-plaintext highlighter-rouge">64</code></li>
                    <li><em>“kernel_size”</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
                    <li><em>“Activation function”</em>: <code class="language-plaintext highlighter-rouge">relu</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“7: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Pooling -- MaxPooling2D</code>
                  <ul>
                    <li><em>“pool_size”</em>: <code class="language-plaintext highlighter-rouge">(2,2)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“8: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Core -- Flatten</code></li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“9: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Core -- Dense</code>
                  <ul>
                    <li><em>“units”</em>”: <code class="language-plaintext highlighter-rouge">256</code></li>
                    <li><em>“Activation function”</em>: <code class="language-plaintext highlighter-rouge">relu</code></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“10: LAYER”</em>:
              <ul>
                <li><em>“Choose the type of layer”</em>: <code class="language-plaintext highlighter-rouge">Core -- Dense</code>
                  <ul>
                    <li><em>“units”</em>”: <code class="language-plaintext highlighter-rouge">10</code></li>
                    <li><em>“Activation function”</em>: <code class="language-plaintext highlighter-rouge">softmax</code></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>
</blockquote>

<p>Each image is passed in as a vector of size 30,000 (100 x 100 X 3 = 30,000). The reshape 
layer reshapes it into (100, 100, 3) dimensions – 100 rows (image height), 100 columns 
(image width), and 3 channels. Channel size is 3 since the image is color (RGB) and each 
color pixel can be represented by 3 integers, representing the Red, Green, and Blue 
primary colors. Our CNN then has 3 convolution + pooling layers. The first convolution layer 
has 16 filters (output channel size would be 16), and filter size is 5 x 5. The second convolutional
layer has 32 filters (output channel size would be 32), and filter size is 5 x 5. The third 
convolutional layer has 64 filters (output channel size would be 64), and filter size is 5 x 5. All
3 pooling layers are MaxPool layers with pool size of 2 x 2. Afterwards, we flatten the previous layer’s 
output (every row/column/channel would be an individual node), then add a fully connected layer with 256
nodes and relu activation function. Finally, we add a fully connected layers with 10 nodes, and use 
softmax activation function to get the probability of each fruit/vegetable. Fruit/vegetable with the 
highest probability is predicted by CNN. The model config can be downloaded as a JSON file.</p>

<h3 id="create-a-deep-learning-model"><strong>Create a deep learning model</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-model-builder-optimizer-loss-function-and-fit-parameters"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Model builder (Optimizer, loss function, and fit parameters)</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/keras_model_builder/keras_model_builder/0.5.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/keras_model_builder/keras_model_builder/0.5.0"><strong>Create deep learning model</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/keras_model_builder/keras_model_builder/0.5.0</span></span>
      <ul>
        <li><em>“Choose a building mode”</em>: <code class="language-plaintext highlighter-rouge">Build a training model</code></li>
        <li><em>“Select the dataset containing model configuration”</em>: Select the <em>Keras Model Config</em> from the previous step.</li>
        <li><em>“Do classification or regression?”</em>: <code class="language-plaintext highlighter-rouge">KerasGClassifier</code></li>
        <li>In <em>“Compile Parameters”</em>:
          <ul>
            <li><em>“Select a loss function”</em>: <code class="language-plaintext highlighter-rouge">categorical_crossentropy</code></li>
            <li><em>“Select an optimizer”</em>: <code class="language-plaintext highlighter-rouge">Adam - Adam optimizer </code></li>
            <li><em>“Select metrics”</em>: <code class="language-plaintext highlighter-rouge">acc/accuracy</code></li>
          </ul>
        </li>
        <li>In <em>“Fit Parameters”</em>:
          <ul>
            <li><em>“epochs”</em>: <code class="language-plaintext highlighter-rouge">40</code></li>
            <li><em>“batch_size”</em>: <code class="language-plaintext highlighter-rouge">50</code></li>
          </ul>
        </li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>
</blockquote>

<p>A loss function measures how different the predicted output is from the expected output. For multi-class classification problems, 
we use <em>categorical cross entropy</em> as loss function. Epochs is the number of times the whole training data is used to train the 
model. Setting <em>epochs</em> to 40 means each training example in our dataset is used 40 times to train our model. If we update network 
weights/biases after all the training data is feed to the network, the training will be very slow (as we have 5014 training examples 
in our dataset). To speed up the training, we present only a subset of the training examples to the network, after which we update 
the weights/biases. <em>batch_size</em> decides the size of this subset. The model builder can be downloaded as a zip file.</p>

<h3 id="deep-learning-training-and-evaluation"><strong>Deep learning training and evaluation</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-training-the-model"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Training the model</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/keras_train_and_eval/keras_train_and_eval/1.0.8.2" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/keras_train_and_eval/keras_train_and_eval/1.0.8.2"><strong>Deep learning training and evaluation</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/keras_train_and_eval/keras_train_and_eval/1.0.8.2</span></span>
      <ul>
        <li><em>“Select a scheme”</em>: <code class="language-plaintext highlighter-rouge">Train and Validate</code></li>
        <li><em>“Choose the dataset containing pipeline/estimator object”</em>: Select the <em>Keras Model Builder</em> from the previous step.</li>
        <li><em>“Select input type:”</em>: <code class="language-plaintext highlighter-rouge">tabular data</code>
          <ul>
            <li><em>“Training samples dataset”</em>: Select <code class="language-plaintext highlighter-rouge">train_X_10</code> dataset</li>
            <li><em>“Choose how to select data by column:”</em>: <code class="language-plaintext highlighter-rouge">All columns</code></li>
            <li><em>“Dataset containing class labels or target values”</em>: Select the OHE representation of <code class="language-plaintext highlighter-rouge">train_y_10</code> dataset</li>
            <li><em>“Choose how to select data by column:”</em>: <code class="language-plaintext highlighter-rouge">All columns</code></li>
          </ul>
        </li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>

</blockquote>

<p>The training step generates 3 datasets. 1) accuracy of the trained model, 2) the trained model, downloadable as a zip file, and 
3) the trained model weights, downloadable as an hdf5 file. These files are needed for prediction in the next step.</p>

<h3 id="model-prediction"><strong>Model Prediction</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-testing-the-model"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Testing the model</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/model_prediction/model_prediction/1.0.8.2" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/model_prediction/model_prediction/1.0.8.2"><strong>Model Prediction</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/model_prediction/model_prediction/1.0.8.2</span></span>
      <ul>
        <li><em>“Choose the dataset containing pipeline/estimator object”</em> : Select the trained model from the previous step.</li>
        <li><em>“Choose the dataset containing weights for the estimator above”</em> : Select the trained model weights from the previous step.</li>
        <li><em>“Select invocation method”</em>: <code class="language-plaintext highlighter-rouge">predict</code></li>
        <li><em>“Select input data type for prediction”</em>: <code class="language-plaintext highlighter-rouge">tabular data</code></li>
        <li><em>“Training samples dataset”</em>: Select <code class="language-plaintext highlighter-rouge">test_X_10</code> dataset</li>
        <li><em>“Choose how to select data by column:”</em>: <code class="language-plaintext highlighter-rouge">All columns</code></li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>

</blockquote>

<p>The prediction step generates 1 dataset. It’s a file that has predictions (0 to 9 for the predicted fruit/vegetable) for every image 
in the test dataset.</p>

<h3 id="machine-learning-visualization-extension"><strong>Machine Learning Visualization Extension</strong></h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-creating-the-confusion-matrix"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Creating the confusion matrix</h3>

  <ul>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/ml_visualization_ex/ml_visualization_ex/1.0.8.2" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/ml_visualization_ex/ml_visualization_ex/1.0.8.2"><strong>Machine Learning Visualization Extension</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/ml_visualization_ex/ml_visualization_ex/1.0.8.2</span></span>
      <ul>
        <li><em>“Select a plotting type”</em>: <code class="language-plaintext highlighter-rouge">Confusion matrix for classes</code></li>
        <li><em>“Select dataset containing the true labels”</em>”: <code class="language-plaintext highlighter-rouge">test_y_10</code></li>
        <li><em>“Does the dataset contain header:”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>“Choose how to select data by column:”</em>: <code class="language-plaintext highlighter-rouge">Select columns by column header name(s)</code>
 	- <em>“Type header name(s):”</em>: <code class="language-plaintext highlighter-rouge">Label</code></li>
        <li><em>“Select dataset containing the predicted labels”</em>”: Select <code class="language-plaintext highlighter-rouge">Model Prediction</code> from the previous step</li>
        <li><em>“Does the dataset contain header:”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li>Click <em>“Execute”</em></li>
      </ul>
    </li>
  </ul>

</blockquote>

<p><strong>Confusion Matrix</strong> is a table that describes the performance of a classification model. It lists the number of examples that were 
correctly classified by the model, True positives (TP) and true negatives (TN). It also lists the number of examples that were 
classified as positive that were actually negative (False positive, FP, or Type I error), and the number of examples that were 
classified as negative that were actually positive (False negative, FN, or Type 2 error). Given the confusion matrix, we can 
calculate <strong>precision</strong> and <strong>recall</strong> <span class="citation"><a href="#TatbulEtAl">Tatbul <i>et al.</i> 2018</a></span>. Precision is the fraction of predicted positives that are true 
positives (Precision = TP / (TP + FP)). Recall is the fraction of true positives that are predicted (Recall = TP / (TP + FN)). 
One way to describe the confusion matrix with just one value is to use the <strong>F score</strong>, which is the harmonic mean of precision 
and recall</p>

\[Precision = \frac{\text{True positives}}{\text{True positives + False positives}}\]

\[Recall = \frac{\text{True positives}}{\text{True positives + False negatives}}\]

\[F score = \frac{2 * \text{Precision * Recall}}{\text{Precision + Recall}}\]

<figure id="figure-10"><img src="../../images/Fruit_confusion_matrix.png" alt="Confusion matrix for fruit 360 image classification problem. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figure 10:</span> Fruits/vegetables image classification confusion matrix</figcaption></figure>

<p>Figure 1 is the resultant confusion matrix for our image classification problem. The first row in the table represents the <em>true</em> 
fruit/vegetable with 0 as class label, which is strawberry (we have 164 strawberry images with 0 as class label). The second row 
represents the <em>true</em> fruit/vegetable with 1 as class label, which is Apple_Red_Delicious (We have 166 Apple_Red_Delicious images 
with 1 as class label). Similarly, you can count the true class labels for fruits/vegetables with class label of 2 to 9 by adding 
up the numbers in the corresponding row. The first column from the left represents the <em>predicted</em> fruit/vegetable with 0 as class 
label, which is strawberry (Our CNN predicted 164 images as being strawberry, and having class label 0). The second column from 
the left represents the <em>predicted</em> fruit/vegetable with 1 as class label, which is Apple_Red_Delicious (Our CNN predicted 166 
images as being Apple_Red_Delicious, and having class label 1). Similarly, you can count the predicted class labels for 
fruits/vegetables with class labels 2 to 9 by adding up the numbers in the corresponding column.</p>

<p>For label 3, which is corn, looking at the green cell in the 4th row and 4th column, we see that our CNN has correctly 
predicted 118 images as being a corn image (True positives). Adding the numbers in the other rows in column 4, we see that 
our CNN has incorrectly predicted 16 images as being corn (False positives). Adding the numbers on the 4th row besides the 
True positives, we see that our CNN has incorrectly predicted 32 corn images as being label Potato_White (False negatives). 
Given these numbers we can calculate Precision, Recall, and the F score for digit 0 as follows:</p>

\[Precision = \frac{\text{True positives}}{\text{True positives + False positives}} = \frac{118}{118 + 16} = 0.88\]

\[Recall = \frac{\text{True positives}}{\text{True positives + False negatives}} = \frac{118}{118 + 32} = 0.78\]

\[F score = \frac{2 * \text{Precision * Recall}}{\text{Precision + Recall}} = \frac{2 * 0.88 * 0.78}{0.88 + 0.78} = 0.82\]

<p>You can calculate the Precision, Recall, and F score for other digits in a similar manner.</p>

<h1 class="no_toc" id="conclusion">Conclusion</h1>

<p>In this tutorial, we briefly described convolutional neural networks (CNN) and their application to image classification problems.
We then used <span class="notranslate">Galaxy</span>’s ML toolkit to solve an image classification problem using CNN on fruit 360 dataset.</p>


                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/statistics/faqs/">FAQ page for the Statistics and machine learning topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="HubelWiesel">Hubel, D. H., and T. N. Wiesel, 1959 <b>Receptive fields of single neurones in the cat’s striate cortex</b>. The Journal of physiology 148: 574–591. <a href="https://doi.org/10.1113/jphysiol.1959.sp006308">10.1113/jphysiol.1959.sp006308</a></li>
<li id="Fukishima">Fukushima, K., 1988 <b>Neocognitron: A hierarchical neural network capable of visual pattern recognition</b>. Neural Networks 1: 119–130. <a href="https://doi.org/https://doi.org/10.1016/0893-6080(88)90014-7">https://doi.org/10.1016/0893-6080(88)90014-7</a> <a href="https://www.sciencedirect.com/science/article/pii/0893608088900147">https://www.sciencedirect.com/science/article/pii/0893608088900147</a></li>
<li id="LeCunEtAl">LeCun, Y., B. Boser, J. S. Denker, D. Henderson, R. E. Howard <i>et al.</i>, 1989 <b>Backpropagation Applied to Handwritten Zip Code Recognition</b>. Neural Computation 1: 541–551. <a href="https://doi.org/10.1162/neco.1989.1.4.541">10.1162/neco.1989.1.4.541</a></li>
<li id="OSheaEtAl">O’Shea, K., and R. Nash, 2015 <b>An Introduction to Convolutional Neural Networks</b>. CoRR abs/1511.08458: <a href="http://arxiv.org/abs/1511.08458">http://arxiv.org/abs/1511.08458</a></li>
<li id="DumoulinVisin">Dumoulin, V., and F. Visin, 2016 <b>A guide to convolution arithmetic for deep learning</b>. <a href="https://doi.org/1603.07285">1603.07285</a></li>
<li id="Iswari2017">Iswari, N. M. S., Wella, and Ranny, 2017 <b>Fruitylicious: Mobile application for fruit ripeness determination based on fruit image</b>, <span style="font-style: normal">in</span> <i>2017 10th International Conference on Human System Interactions (HSI)</i>, <i>IEEE</i>. <a href="https://doi.org/10.1109/hsi.2017.8005025">10.1109/hsi.2017.8005025</a></li>
<li id="Kamilaris2018">Kamilaris, A., and F. X. Prenafeta-Boldú, 2018 <b>Deep learning in agriculture: A survey</b>. Computers and Electronics in Agriculture 147: 70–90. <a href="https://doi.org/10.1016/j.compag.2018.02.016">10.1016/j.compag.2018.02.016</a></li>
<li id="Murean2018">Mureşan, H., and M. Oltean, 2018 <b>Fruit recognition from images using deep learning</b>. Acta Universitatis Sapientiae,  Informatica 10: 26–42. <a href="https://doi.org/10.2478/ausi-2018-0002">10.2478/ausi-2018-0002</a></li>
<li id="NwankpaEtAl">Nwankpa, C., W. Ijomah, A. Gachagan, and S. Marshall, 2018 <b>Activation Functions: Comparison of trends in Practice and Research for Deep Learning</b>. CoRR abs/1811.03378: <a href="http://arxiv.org/abs/1811.03378">http://arxiv.org/abs/1811.03378</a></li>
<li id="TatbulEtAl">Tatbul, N., T. J. Lee, S. Zdonik, M. Alam, and J. Gottschlich, 2018 <b>Precision and Recall for Time Series</b>. Advances in Neural Information Processing Systems 31: 1920–1930. <a href="https://proceedings.neurips.cc/paper/2018/file/8f468c873a32bb0619eaeb2050ba45d1-Paper.pdf">https://proceedings.neurips.cc/paper/2018/file/8f468c873a32bb0619eaeb2050ba45d1-Paper.pdf</a></li>
<li id="Duong2020">Duong, L. T., P. T. Nguyen, C. D. Sipio, and D. D. Ruscio, 2020 <b>Automated fruit recognition using EfficientNet and MixNet</b>. Computers and Electronics in Agriculture 171: 105326. <a href="https://doi.org/10.1016/j.compag.2020.105326">10.1016/j.compag.2020.105326</a></li>
<li id="NaranjoTorres2020">Naranjo-Torres, J., M. Mora, Hernández-Garcı́a Ruber, R. J. Barrientos, C. Fredes <i>et al.</i>, 2020 <b>A Review of Convolutional Neural Network Applied to Fruit Image Processing</b>. Applied Sciences 10: 3443. <a href="https://doi.org/10.3390/app10103443">10.3390/app10103443</a></li></ol>
                

                

                <h1>Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <div id="feedback-button">
                    <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                </div>
                <div id="feedback-form">
                </div>
                <script type="text/javascript">
                    (function (window, document) {
                        function onDocumentReady(fn) {
                            if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                fn();
                            } else {
                                document.addEventListener('DOMContentLoaded', fn);
                            }
                        }

                        onDocumentReady(function () {
                            $("#feedback-button").click(function(evt){
                                var e = $(evt.target)
                                e.hide();

                                $("#feedback-form").html(`
                                    <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Image classification in Galaxy with fruit 360 dataset (Statistics and machine learning)">Loading...</iframe>
                                `)
                            })
                        });
                    })(window, document);
                </script>



                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">Kaivan Kamali, 2022 <b>Image classification in Galaxy with fruit 360 dataset (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/statistics/tutorials/fruit_360/tutorial.html">https://training.galaxyproject.org/training-material/topics/statistics/tutorials/fruit_360/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>


                <blockquote class="details">
                  <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                  <p style="display: none;">

                <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{statistics-fruit_360,
author = "Kaivan Kamali",
title = "Image classification in Galaxy with fruit 360 dataset (Galaxy Training Materials)",
year = "2022",
month = "01",
day = "04"
url = "\url{https://training.galaxyproject.org/training-material/topics/statistics/tutorials/fruit_360/tutorial.html}",
note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
    doi = {10.1016/j.cels.2018.05.012},
    url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
    year = 2018,
    month = {jun},
    publisher = {Elsevier {BV}},
    volume = {6},
    number = {6},
    pages = {752--758.e1},
    author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Björn Grüning},
    title = {Community-Driven Data Analysis Training for Biology},
    journal = {Cell Systems}
}</code>
                </pre></div></div>
                </p>
                </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                <h3><i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!</h3>

                

                

            </div>
        </div>
    </div>
</section>
<br/>
<br/>
<br/>

        </div>
        
    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
