<!DOCTYPE html>
<html>











  <head>
    <meta charset="utf-8">
    <title>Recurrent neural networks (RNN) 
 Deep Learning - Part 2</title>
    
        <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

    
    <link rel="stylesheet" href="/training-material/assets/css/slides.css">
    <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

    
    
    
    
    <meta name="description" content="Statistical Analyses for omics data and machine learning ..." />
    <meta property="og:title" content="Galaxy Training: Recurrent neural networks (RNN) 
 Deep Learning - Part 2" />
    <meta property="og:description" content="Statistical Analyses for omics data and machine learning ..." />
    <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    <script type="application/ld+json">
      


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "1970-01-01 00:33:41 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Recurrent neural networks (RNN) \n Deep Learning - Part 2",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Statistics and machine learning",
    "description": "Statistical Analyses for omics data and machine learning using Galaxy tools",
    "url": "https://training.galaxyproject.org//training-material/topics/statistics/"
  },
  "courseCode": "statistics / RNN / slides",
  "learningResourceType": "slides",
  "name": "Slides for 'Recurrent neural networks (RNN) \n Deep Learning - Part 2' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/RNN/slides.html",
  "description": "The questions this  addresses are:\n - What is a recurrent neural network (RNN)?\n - What are some applications of RNN?\n\n\\nThe objectives are:\n - Understand the difference between feedforward neural networks (FNN) and RNN\n - Learn various RNN types and architectures\n - Learn how to create a neural network using Galaxyâ€™s deep learning tools\n - Solve a sentiment analysis problem on IMDB movie review dataset using RNN in Galaxy\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/intro_deep_learning/tutorial.html",
      "name": "Introduction to deep learning",
      "description": "Hands-on for 'Introduction to deep learning' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/FNN/slides.html",
      "name": "Feedforward neural networks (FNN) \n Deep Learning - Part 1",
      "description": "Slides for 'Feedforward neural networks (FNN) \n Deep Learning - Part 1' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/FNN/tutorial.html",
      "name": "Deep Learning (Part 1) - Feedforward neural networks (FNN)",
      "description": "Hands-on for 'Deep Learning (Part 1) - Feedforward neural networks (FNN)' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/tutorials/FNN/slides.html",
      "name": "Feedforward neural networks (FNN) \n Deep Learning - Part 1",
      "description": "Slides for 'Feedforward neural networks (FNN) \n Deep Learning - Part 1' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Kaivan Kamali"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Kaivan Kamali"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Statistics and machine learning",
      "description": "Statistical Analyses for omics data and machine learning using Galaxy tools",
      "url": "https://training.galaxyproject.org//training-material/topics/statistics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_2269",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_2269",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_2269"
    }
  ]
}
    </script>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
  </head>
  <body>
    <textarea id="source">
name: inverse
layout: true
class: center, middle, inverse

<div class="my-header"><span>
<a href="/training-material/topics/statistics" title="Return to topic page" ><i class="fa fa-level-up" aria-hidden="true"></i></a>

<a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/main/topics/statistics/tutorials/RNN/slides.html"><i class="fa fa-pencil" aria-hidden="true"></i></a>

</span></div>

<div class="my-footer"><span>

<img src="/training-material/assets/images/GTN-60px.png" alt="Galaxy Training Network" style="height: 40px;"/>

</span></div>

---



<img src="/training-material/assets/images/GTN.png" alt="Galaxy Training Network" class="cover-logo"/>


# Recurrent neural networks (RNN) 
 Deep Learning - Part 2


<div class="contributors-line">

<a href="/training-material/hall-of-fame/kxk302/" class="contributor-badge contributor-kxk302"><img src="https://avatars.githubusercontent.com/kxk302?s=27" alt="Avatar">Kaivan Kamali</a>


<a href="https://training.galaxyproject.org/training-material/topics/contributing/" class="contributor-badge contributor-newcontributors"><i class="fas fa-users" aria-hidden="true"></i><span class="visually-hidden">hall-of-fame</span>Add Contributions!</a>


</div>


<div class="footnote" style="bottom: 4 em;"><i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Updated: May 27, 2021</div>

<div class="footnote" style="bottom: 2.5em;"><i class="fas fa-file-alt" aria-hidden="true"></i><span class="visually-hidden">text-document</span><a href="slides-plain.html"> Plain-text slides</a></div>
<div class="footnote" style="bottom: 1em;"><strong>Tip: </strong>press <kbd>P</kbd> to view the presenter notes</div>

???
Presenter notes contain extra information which might be useful if you intend to use these slides for teaching.

Press `P` again to switch presenter notes off

Press `C` to create a new window where the same presentation will be displayed.
This window is linked to the main window. Changing slides on one will cause the
slide to change on the other.

Useful when presenting.



---

## Requirements

Before diving into this slide deck, we recommend you to have a look at:



    
        
        
            
        
- [Introduction to Galaxy Analyses](/training-material/topics/introduction)
    



    
        
        
            
        
- [Statistics and machine learning](/training-material/topics/statistics)
    - Introduction to deep learning: [<i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on](/training-material/topics/statistics/tutorials/intro_deep_learning/tutorial.html)
    - Deep Learning (Part 1) - Feedforward neural networks (FNN): [<i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides](/training-material/topics/statistics/tutorials/FNN/slides.html) - [<i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on](/training-material/topics/statistics/tutorials/FNN/tutorial.html)
    




---







### &lt;i class=&quot;far fa-question-circle&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;span class=&quot;visually-hidden&quot;&gt;question&lt;/span&gt; Questions


- What is a recurrent neural network (RNN)?

- What are some applications of RNN?


---



### &lt;i class=&quot;fas fa-bullseye&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;span class=&quot;visually-hidden&quot;&gt;objectives&lt;/span&gt; Objectives


- Understand the difference between feedforward neural networks (FNN) and RNN

- Learn various RNN types and architectures

- Learn how to create a neural network using Galaxyâ€™s deep learning tools

- Solve a sentiment analysis problem on IMDB movie review dataset using RNN in Galaxy


---


# What is a recurrent neural network (RNN)?

???

What is a recurrent neural network (RNN)?

---

# Recurrent Neural Network (RNN)

- RNN models sequential data (temporal/ordinal)
- In RNN, training example is a sequence, which is presented to RNN one at a time 
	- E.g., sequence of English words is passed to RNN, one at a time 
	- And, RNN generates a sequence of Persian words, one at a time
- In RNN, output of network at time *t* is used as input at time *t+1*
- RNN applied to image description, machine translation, sentiment analysis, etc. 

---

# One-to-many RNN

![Neurons forming a one-to-many recurrent neural network](/training-material/topics/statistics/images/RNN_1_to_n.png) &lt;!-- https://pixy.org/3013900/ CC0 license--&gt;

---

# Many-to-one RNN

![Neurons forming a many-to-one recurrent neural network](/training-material/topics/statistics/images/RNN_n_to_1.png) &lt;!-- https://pixy.org/3013900/ CC0 license--&gt;

---

# Many-to-many RNN

![Neurons forming a many-to-many recurrent neural network](/training-material/topics/statistics/images/RNN_n_to_m.png) &lt;!-- https://pixy.org/3013900/ CC0 license--&gt;

---

# RNN architectures

- Vanilla RNN
	- Suffers from *vanishing gradient* problem
- LSTM and GRU
	- Uses *gates* to avoid vanishing gradient problem

---

# Sentiment analysis

- We perform sentiment analysis on IMDB movie reviews dataset
- Train RNN on training dataset (25000 positive/negative movie reviews)
- Test RNN on test set (25000 positive/negative movie reviews)
- Training and test sets have no overlap
- Since dealing with text data, good to review mechanisms for representing text data

---

# Text preprocessing

- Tokenize a document, i.e., break it down into words
- Remove punctuations, URLs, and stop words (â€˜aâ€™, â€˜ofâ€™, â€˜theâ€™, etc.)
- Normalize the text, e.g., replace â€˜brbâ€™ with â€˜Be right backâ€™, etc
- Run the spell checker to fix typos
- Make all words lowercase

---

# Text preprocessing

- Perform stemming/lemmatization
	- If we have words like â€˜organizerâ€™, â€˜organizeâ€™, and â€˜organizedâ€™
		- Want to reduce all of them to a single word
	- Stemming cuts end of these words for a single root
		- E.g., â€˜organizâ€™.  May not be an actual word
	- Lemmatization reduces to a root that is actually a word
		- E.g., â€˜organizeâ€™

---

# Bag of words (BoW)

- If you donâ€™t care about the order of the words in a document
- 2D array. Rows represent documents. Columns represent words in vocabulary
	- All unique words in all documents
- If a word not present in a document, we have a zero at row and column entry
- If a word is present in a document, we have a one at row and colum entry
	- Or, we could use the word count or frequency

---

# Bag of words (BoW)

- Document 1: Magic passed the basketball to Kareem
- Document 2: Lebron stole the basketball from Curry

![Table showing a bag-of-words representation of sample documents](/training-material/topics/statistics/images/BoW.png) &lt;!-- https://pixy.org/3013900/ CC0 license--&gt;

- BoW is simple, but does not consider rarity of words across documents
	- Important for document classification

---

# Term frequency inverse document frequency (TF-IDF)

- If you donâ€™t care about the order of the words in a document
- Similar to BoW, we have an entry for each document-word pair
- Entry is product of
	- Term frequency, frequency of a word in a document, and
	- Inverse document frequency, total number of documents divided by number of documents that have word
		- Usually use logarithm of the IDF
- TF-IDF takes into account rarity of a word across documents

---

# One-hot encoding (OHE)

- Technique to convert categorical variables such as words into a vector
- Suppose our vocabulary has 3 words: orange, apple, banana
- Each word is represented by a vector of size 3

![Mathematical vectors representing one-hot-encoding representation of words orange, apple, and banana](/training-material/topics/statistics/images/OHE.gif) &lt;!-- https://pixy.org/3013900/ CC0 license--&gt;

- OHE problems
	- For very large vocabulary sizes requires tremendous amount of storage
	- Also, no concept of word similarity

---

# Word2Vec

- Each word represented as an *n* dimensional vector
	- *n* much smaller than vocabulary size
- Words that have similar meanings are close in vector space
- Words considered similar if they co-occur often in documents
- Two Word2Vec architectures
	- Continuous BoW
		- predicts probability of a word given the surrounding words
	- Continuous skip-gram
		- given a word predicts probability of the surrounding words

---

# Sentiment analysis

- Sentiment classification of IMDB movie reviews with RNN
- Train RNN using IMDB movie reviews
- Goal is to learn a model such that given a review we predict whether review is positive/negative
- We evaluate the trained RNN on test dataset and plot confusion matrix

---

# For references, please see tutorial's References section

---









---

## Thank You!

This material is the result of a collaborative work. Thanks to the [Galaxy Training Network](https://training.galaxyproject.org) and all the contributors!


<div class="contributors-line">

<a href="/training-material/hall-of-fame/kxk302/" class="contributor-badge contributor-kxk302"><img src="https://avatars.githubusercontent.com/kxk302?s=27" alt="Avatar">Kaivan Kamali</a>


</div>



<img src="/training-material/assets/images/GTN.png" alt="Galaxy Training Network" style="height: 100px;"/>


<a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
This material is licensed under the Creative Commons Attribution 4.0 International License</a>.


    </textarea>
	<script src="/training-material/assets/js/remark-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
      var slideshow = remark.create({navigation: {scroll: false}, ratio: '16:9'});
      var hljs = remark.highlighter.engine;
      var snippets = document.querySelectorAll('code.remark-code');
        [].forEach.call(snippets,function(snippet){
          snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
        });
      var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.parentElement;
      }});
    </script>

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('body').prepend("<div style='text-align: center'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>

  </body>
</html>
